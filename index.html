<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
  <meta name="theme-color" content="#0d2035"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="Metabisulfito"/>
  <link rel="manifest" href="manifest.json"/>
  <title>Control Metabisulfito ‚Äî Sta. Rosa</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap');
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{
      --bg:#0a0f1a;--surface:#111827;--surface2:#1a2332;--card:#1e2d3d;
      --border:#1f3347;--border2:#2d4a63;--text:#f0f6ff;--muted:#7a9bb5;
      --blue:#3b9eff;--blue2:#1d6fa8;--cyan:#06d6f7;--green:#10e89a;
      --orange:#ff8c42;--pink:#f06292;--yellow:#ffd166;--red:#ff5252;
      --purple:#a78bfa;
      --grad1:linear-gradient(135deg,#1d6fa8,#06d6f7);
      --grad2:linear-gradient(135deg,#10b981,#06d6f7);
      --grad3:linear-gradient(135deg,#f06292,#a78bfa);
      --shadow:0 8px 32px rgba(0,0,0,.5);
    }
    html{scroll-behavior:smooth}
    body{background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;min-height:100vh;overflow-x:hidden}

    /* ===== LOADING ===== */
    #loading-screen{position:fixed;inset:0;z-index:9999;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px}
    .load-icon{font-size:64px;animation:float 2s ease-in-out infinite}
    .load-bar{width:200px;height:3px;background:#1f3347;border-radius:99px;overflow:hidden}
    .load-progress{height:100%;background:var(--grad1);border-radius:99px;animation:loadbar 2s ease-in-out infinite}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}
    @keyframes loadbar{0%{width:0%}100%{width:100%}}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .spinner{display:inline-block;width:16px;height:16px;border:2px solid #ffffff30;border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite}

    /* ===== LOGIN ===== */
    #login-screen{display:none;position:fixed;inset:0;z-index:999;background:radial-gradient(ellipse at 50% 30%,#0d2540 0%,#0a0f1a 70%);align-items:center;justify-content:center;padding:20px}
    .login-wrap{width:100%;max-width:420px;animation:fadeIn .4s ease}
    .login-card{background:var(--surface);border:1px solid var(--border2);border-radius:24px;padding:40px 36px;box-shadow:var(--shadow)}
    .login-header{text-align:center;margin-bottom:32px}
    .login-icon{font-size:52px;display:block;margin-bottom:12px}
    .login-title{font-size:20px;font-weight:800;color:#e0f4ff;letter-spacing:.5px}
    .login-sub{font-size:11px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-top:4px}
    .lfield{margin-bottom:18px}
    .lfield label{display:block;font-size:11px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:7px}
    .lfield input{width:100%;background:var(--bg);border:1.5px solid var(--border2);border-radius:12px;padding:13px 16px;color:var(--text);font-size:15px;font-family:'Inter',sans-serif;outline:none;transition:border-color .2s}
    .lfield input:focus{border-color:var(--blue)}
    .btn-login{width:100%;background:var(--grad1);color:#fff;border:none;border-radius:12px;padding:14px;font-size:15px;font-weight:700;font-family:'Inter',sans-serif;cursor:pointer;letter-spacing:.5px;transition:opacity .2s;margin-top:4px}
    .btn-login:hover{opacity:.9}
    .btn-login:disabled{opacity:.5;cursor:not-allowed}
    .lerror{background:#2d0a0a;border:1px solid #991b1b;color:#fca5a5;border-radius:10px;padding:10px 14px;font-size:13px;margin-bottom:16px;display:none}

    /* ===== HEADER ===== */
    .header{background:linear-gradient(135deg,#0d2035,#091624);border-bottom:1px solid var(--border2);padding:14px 20px;display:flex;align-items:center;gap:12px;position:sticky;top:0;z-index:100}
    .h-logo{width:40px;height:40px;background:var(--grad1);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
    .h-info{flex:1;min-width:0}
    .h-title{font-size:14px;font-weight:700;color:#e0f4ff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .h-sub{font-size:10px;color:var(--muted);letter-spacing:1px}
    .h-right{display:flex;align-items:center;gap:8px;flex-shrink:0}
    .rbadge{border-radius:20px;padding:3px 10px;font-size:10px;font-weight:700;white-space:nowrap}
    .rbadge-admin{background:#ffd16622;color:var(--yellow);border:1px solid #ffd16644}
    .rbadge-operario{background:#3b9eff22;color:var(--blue);border:1px solid #3b9eff44}
    .btn-out{background:transparent;border:1px solid var(--border2);color:var(--muted);border-radius:8px;padding:6px 10px;font-size:11px;cursor:pointer;font-family:'Inter',sans-serif}

    /* ===== BOTTOM NAV ===== */
    .bottom-nav{position:fixed;bottom:0;left:0;right:0;z-index:100;background:var(--surface);border-top:1px solid var(--border2);display:flex;padding:0 0 env(safe-area-inset-bottom)}
    .nav-btn{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10px 4px 8px;cursor:pointer;border:none;background:none;color:var(--muted);font-size:9px;font-family:'Inter',sans-serif;font-weight:600;letter-spacing:.5px;text-transform:uppercase;transition:color .2s;gap:4px}
    .nav-btn .ni{font-size:20px;transition:transform .2s}
    .nav-btn.active{color:var(--blue)}
    .nav-btn.active .ni{transform:scale(1.15)}

    /* ===== MAIN ===== */
    .main{padding:16px 16px 90px;max-width:900px;margin:0 auto}

    /* ===== SECTION ===== */
    .card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:18px;margin-bottom:14px;animation:fadeIn .3s ease}
    .card-title{font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--cyan);margin-bottom:14px;display:flex;align-items:center;gap:8px}

    /* ===== FORM ===== */
    .fgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px}
    .fgrid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .field{display:flex;flex-direction:column;gap:6px}
    .field label{font-size:11px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.8px}
    .field input,.field select,.field textarea{
      background:var(--bg);border:1.5px solid var(--border2);border-radius:10px;
      padding:11px 13px;color:var(--text);font-size:14px;font-family:'Inter',sans-serif;
      outline:none;transition:border-color .2s;width:100%;
      -webkit-appearance:none;appearance:none
    }
    .field input:focus,.field select:focus,.field textarea:focus{border-color:var(--blue)}
    .field textarea{resize:none;min-height:72px}
    .field select{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%237a9bb5' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:34px}

    /* Date/time pickers look native but styled */
    input[type="date"],input[type="time"]{color-scheme:dark;min-height:46px}

    /* ===== BUTTONS ===== */
    .btn{border:none;border-radius:12px;padding:13px 20px;font-size:14px;font-weight:700;font-family:'Inter',sans-serif;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:8px;justify-content:center}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .btn-primary{background:var(--grad1);color:#fff;width:100%}
    .btn-primary:hover:not(:disabled){opacity:.9}
    .btn-sm{padding:6px 12px;font-size:12px;border-radius:8px;font-weight:600}
    .btn-danger{background:#2d0a0a;color:var(--red);border:1px solid #991b1b}
    .btn-info{background:#0a1f35;color:var(--blue);border:1px solid var(--border2)}
    .btn-success{background:#052e1a;color:var(--green);border:1px solid #065f46}
    .btn-warn{background:#2d1a00;color:var(--orange);border:1px solid #92400e}
    .btn-ghost{background:var(--surface2);color:var(--muted);border:1px solid var(--border)}

    /* ===== ALERTS ===== */
    #alert-box{position:fixed;top:70px;left:50%;transform:translateX(-50%);z-index:500;width:calc(100% - 32px);max-width:500px;pointer-events:none}
    .alert{border-radius:12px;padding:12px 16px;font-size:13px;font-weight:600;box-shadow:var(--shadow);animation:fadeIn .3s ease;pointer-events:all}
    .alert-success{background:#052e1a;border:1px solid #065f46;color:#6ee7b7}
    .alert-error{background:#2d0a0a;border:1px solid #991b1b;color:#fca5a5}
    .alert-info{background:#0a1f35;border:1px solid var(--border2);color:var(--blue)}

    /* ===== BADGES ===== */
    .badge{border-radius:20px;padding:3px 10px;font-size:10px;font-weight:700;display:inline-block;white-space:nowrap}
    .b-blue{background:#3b9eff22;color:var(--blue);border:1px solid #3b9eff44}
    .b-green{background:#10e89a22;color:var(--green);border:1px solid #10e89a44}
    .b-orange{background:#ff8c4222;color:var(--orange);border:1px solid #ff8c4244}
    .b-pink{background:#f0629222;color:var(--pink);border:1px solid #f0629244}
    .b-yellow{background:#ffd16622;color:var(--yellow);border:1px solid #ffd16644}
    .b-red{background:#ff525222;color:var(--red);border:1px solid #ff525244}
    .b-purple{background:#a78bfa22;color:var(--purple);border:1px solid #a78bfa44}

    /* ===== EXCEL IMPORT ROW ===== */
    .excel-row td { border-left: 3px solid var(--yellow) !important; }
    .excel-badge { background:#ffd16622;color:var(--yellow);border:1px solid #ffd16644;border-radius:4px;font-size:9px;padding:1px 5px;font-weight:700;vertical-align:middle;margin-left:4px }

    /* ===== NUM BADGE ===== */
    .num-badge{background:#0a1f35;border:1px solid var(--border2);border-radius:10px;padding:8px 16px;font-size:14px;color:var(--blue);font-weight:700;font-family:'JetBrains Mono',monospace}

    /* ===== TOP BAR ===== */
    .top-bar{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px}
    .page-title{font-size:20px;font-weight:800;color:#e0f4ff}

    /* ===== TABLE ===== */
    .tbl-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch;border-radius:12px}
    table{width:100%;border-collapse:collapse;font-size:12px;min-width:600px}
    th{background:var(--bg);color:var(--muted);padding:10px 12px;text-align:left;font-size:10px;letter-spacing:1px;text-transform:uppercase;border-bottom:2px solid var(--border);white-space:nowrap}
    td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:middle}
    tfoot td{border-top:2px solid var(--border2);font-weight:700}
    .act{display:flex;gap:6px;flex-wrap:wrap}

    /* ===== STATS GRID ===== */
    .stats-row{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-bottom:16px}
    .stat-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;text-align:center;position:relative;overflow:hidden}
    .stat-card::before{content:'';position:absolute;top:-20px;right:-20px;width:70px;height:70px;border-radius:50%;opacity:.1}
    .stat-card.sc1::before{background:var(--blue)}
    .stat-card.sc2::before{background:var(--orange)}
    .stat-card.sc3::before{background:var(--green)}
    .stat-card.sc4::before{background:var(--pink)}
    .stat-card.sc5::before{background:var(--purple)}
    .stat-icon{font-size:22px;margin-bottom:6px}
    .stat-num{font-size:22px;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1.1}
    .stat-label{font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-top:4px}
    .sc1 .stat-num{color:var(--blue)}
    .sc2 .stat-num{color:var(--orange)}
    .sc3 .stat-num{color:var(--green)}
    .sc4 .stat-num{color:var(--pink)}
    .sc5 .stat-num{color:var(--purple)}

    /* ===== CHARTS ===== */
    .charts-grid{display:grid;grid-template-columns:1fr;gap:14px}
    @media(min-width:640px){.charts-grid{grid-template-columns:1fr 1fr}}
    .chart-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px}
    .chart-title{font-size:12px;font-weight:700;color:var(--cyan);text-transform:uppercase;letter-spacing:1px;margin-bottom:14px}
    .chart-wrap{position:relative;height:220px}

    /* ===== DESTINOS ===== */
    .destinos-list{display:flex;flex-direction:column;gap:8px;max-height:280px;overflow-y:auto}
    .destino-row{display:flex;align-items:center;gap:10px;padding:10px 12px;background:var(--surface2);border-radius:10px}
    .destino-bar-wrap{flex:1;height:6px;background:var(--border);border-radius:99px;overflow:hidden}
    .destino-bar{height:100%;background:var(--grad1);border-radius:99px;transition:width .6s ease}
    .destino-name{font-size:12px;font-weight:600;min-width:100px}
    .destino-count{font-size:11px;color:var(--muted);font-family:'JetBrains Mono',monospace;white-space:nowrap}

    /* ===== MODAL ===== */
    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:flex-end;justify-content:center;z-index:300;padding:0}
    @media(min-width:600px){.modal-overlay{align-items:center;padding:20px}}
    .modal-box{background:var(--surface);border-radius:24px 24px 0 0;padding:24px;width:100%;max-width:720px;max-height:92vh;overflow-y:auto}
    @media(min-width:600px){.modal-box{border-radius:20px}}
    .modal-handle{width:36px;height:4px;background:var(--border2);border-radius:99px;margin:0 auto 20px}
    .modal-title{font-size:17px;font-weight:800;color:#e0f4ff;margin-bottom:16px}
    .det-sec{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:10px}
    .det-title{font-size:10px;font-weight:700;color:var(--cyan);text-transform:uppercase;letter-spacing:2px;margin-bottom:10px}
    .det-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px 12px}
    .det-row{display:flex;flex-direction:column;gap:2px}
    .det-lbl{font-size:10px;color:var(--muted)}
    .det-val{font-size:13px;font-weight:500}

    /* ===== USUARIOS ===== */
    .user-row{display:flex;align-items:center;gap:12px;padding:14px 0;border-bottom:1px solid var(--border)}
    .user-row:last-child{border-bottom:none}
    .u-avatar{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;flex-shrink:0}
    .ua-admin{background:#ffd16622;color:var(--yellow);border:1px solid #ffd16644}
    .ua-op{background:#3b9eff22;color:var(--blue);border:1px solid #3b9eff44}
    .u-info{flex:1;min-width:0}
    .u-name{font-size:14px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .u-email{font-size:11px;color:var(--muted);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .u-actions{display:flex;gap:6px;flex-wrap:wrap;flex-shrink:0}

    /* ===== FILTERS ===== */
    .filter-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(min-width:480px){.filter-grid{grid-template-columns:repeat(3,1fr)}}

    /* ===== EMPTY ===== */
    .empty{text-align:center;padding:48px 20px;color:var(--muted);font-size:14px}
    .empty .ei{font-size:40px;display:block;margin-bottom:10px;opacity:.5}

    /* ===== SAFE AREA ===== */
    .safe-bottom{height:env(safe-area-inset-bottom)}

    @media(max-width:400px){
      .fgrid{grid-template-columns:1fr 1fr}
      .h-title{font-size:12px}
    }
  </style>
</head>
<body>

<!-- LOADING -->
<div id="loading-screen">
  <div class="load-icon">üß™</div>
  <div style="font-size:14px;color:#7a9bb5;font-weight:600">Iniciando sistema...</div>
  <div class="load-bar"><div class="load-progress"></div></div>
</div>

<!-- LOGIN -->
<div id="login-screen">
  <div class="login-wrap">
    <div class="login-card">
      <div class="login-header">
        <span class="login-icon">üß™</span>
        <div class="login-title">Control Metabisulfito</div>
        <div class="login-sub">Bodega Sta. Rosa</div>
      </div>
      <div id="lerror" class="lerror"></div>
      <div class="lfield">
        <label>Correo electr√≥nico</label>
        <input id="l-email" type="email" placeholder="usuario@empresa.com" inputmode="email" autocomplete="email" onkeydown="if(event.key==='Enter')doLogin()"/>
      </div>
      <div class="lfield">
        <label>Contrase√±a</label>
        <input id="l-pass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" onkeydown="if(event.key==='Enter')doLogin()"/>
      </div>
      <button class="btn-login" id="btn-login" onclick="doLogin()">INGRESAR AL SISTEMA</button>
    </div>
  </div>
</div>

<!-- APP -->
<div id="app-screen" style="display:none">

  <!-- HEADER -->
  <div class="header">
    <div class="h-logo">üß™</div>
    <div class="h-info">
      <div class="h-title">Control Metabisulfito</div>
      <div class="h-sub" id="h-user-name">‚Äî</div>
    </div>
    <div class="h-right">
      <span id="h-role" class="rbadge rbadge-operario">operario</span>
      <button class="btn-out" onclick="doLogout()">Salir</button>
    </div>
  </div>

  <!-- ALERT -->
  <div id="alert-box"></div>

  <!-- MAIN CONTENT -->
  <div class="main">

    <!-- ====== TAB 0: NUEVO REGISTRO ====== -->
    <div id="tab-0">
      <div class="top-bar">
        <div class="page-title">Nuevo Despacho</div>
        <div class="num-badge">N¬∞ <span id="next-num">00001</span></div>
      </div>

      <div class="card">
        <div class="card-title">üöõ Transportista</div>
        <div class="fgrid">
          <div class="field" style="grid-column:1/-1">
            <label>Conductor &#9733;</label>
            <select id="f-conductor" onchange="autoPlaca(this.value)" style="background:var(--bg);border:1.5px solid var(--border2);border-radius:10px;padding:11px 13px;color:var(--text);font-size:14px;font-family:inherit;outline:none;width:100%">
              <option value="">-- Seleccionar conductor --</option>
              <option value="ARGUELLO SOLORZANO PEDRO ANIBAL" data-placa="PCD9219">ARGUELLO SOLORZANO PEDRO ANIBAL &mdash; PCD9219</option>
              <option value="ALBAN VALAREZO MANUEL JOSELITO" data-placa="OBA3449">ALBAN VALAREZO MANUEL JOSELITO &mdash; OBA3449</option>
              <option value="RODRIGUEZ PARDO VICENTE ROBERTO" data-placa="GQZ0299">RODRIGUEZ PARDO VICENTE ROBERTO &mdash; GQZ0299</option>
              <option value="SANMARTIN QUEZADA JOSE LUIS" data-placa="TCM0261">SANMARTIN QUEZADA JOSE LUIS &mdash; TCM0261</option>
              <option value="RODRIGUEZ AYALA FREDDY HERNEY" data-placa="OAA1854">RODRIGUEZ AYALA FREDDY HERNEY &mdash; OAA1854</option>
              <option value="JIMENEZ CHAMBA SANTOS GABRIEL" data-placa="PIA0438">JIMENEZ CHAMBA SANTOS GABRIEL &mdash; PIA0438</option>
              <option value="SOTO CHIMBO JOSE JOEL" data-placa="XBW0304">SOTO CHIMBO JOSE JOEL &mdash; XBW0304</option>
              <option value="ULLOA CABRERA KEVIN JONATHAN" data-placa="LCH0740">ULLOA CABRERA KEVIN JONATHAN &mdash; LCH0740</option>
              <option value="GANCHOZO VELEZ PEDRO LEONARDO" data-placa="OAA4374">GANCHOZO VELEZ PEDRO LEONARDO &mdash; OAA4374</option>
              <option value="RODRIGUEZ TORRES FREDY HERNEY" data-placa="GSG7573">RODRIGUEZ TORRES FREDY HERNEY &mdash; GSG7573</option>
              <option value="MERA VALENCIA RAMON BENIGNO" data-placa="AFZ0931">MERA VALENCIA RAMON BENIGNO &mdash; AFZ0931</option>
              <option value="VALAREZO CUEVA REMIGIO DE JESUS" data-placa="GBO8135">VALAREZO CUEVA REMIGIO DE JESUS &mdash; GBO8135</option>
              <option value="OTRO" data-placa="">OTRO (ingresar manualmente)</option>
            </select>
          </div>
          <div class="field"><label>Placa del Veh√≠culo</label><input id="f-placa" type="text" placeholder="Se llena automaticamente" autocomplete="off" readonly style="background:#0a1520;color:var(--cyan);font-weight:700"/></div>
          <div class="field" id="f-conductor-manual-wrap" style="display:none"><label>Nombre conductor (otro)</label><input id="f-conductor-manual" type="text" placeholder="Ingresa el nombre"/></div>
        </div>
        <div style="height:12px"></div>
        <div class="fgrid">
          <div class="field"><label>Fecha Inicio</label><input id="f-fechaInicio" type="date"/></div>
          <div class="field"><label>Hora de Salida</label><input id="f-horaSalida" type="time"/></div>
          <div class="field"><label>Punto de Partida</label><input id="f-puntoPartida" type="text" placeholder="Ej: Bodega Sta. Rosa"/></div>
          <div class="field"><label>Fecha Fin</label><input id="f-fechaFin" type="date"/></div>
          <div class="field"><label>Hora de Llegada</label><input id="f-horaLlegada" type="time"/></div>
          <div class="field"><label>Punto de Llegada</label><input id="f-puntoLlegada" type="text" placeholder="Destino"/></div>
          <div class="field"><label>Ruta</label><input id="f-ruta" type="text" placeholder="Descripci√≥n de ruta"/></div>
          <div class="field"><label>Gu√≠a MDI</label><input id="f-guiaMdi" type="text"/></div>
          <div class="field"><label>Lugar de Pesca / Productor</label><input id="f-lugarPesca" type="text"/></div>
          <div class="field"><label>Nro. Gu√≠a Remisi√≥n</label><input id="f-nroGuia" type="text"/></div>
          <div class="field"><label>C√≥digo Recibidor</label><input id="f-codRecibidor" type="text"/></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üì¶ Despacho</div>
        <div class="fgrid">
          <div class="field"><label>Fecha del Despacho ‚òÖ</label><input id="f-fechaDespacho" type="date"/></div>
          <div class="field"><label>Solicitado Por</label><input id="f-solicitadoPor" type="text"/></div>
          <div class="field"><label>Despachado Por</label><input id="f-despachador" type="text"/></div>
          <div class="field"><label>Cantidad Sacos</label><input id="f-cantSacos" type="number" min="0" placeholder="0" inputmode="decimal"/></div>
          <div class="field"><label>Cantidad en KG</label><input id="f-cantKg" type="number" min="0" step="0.01" placeholder="0.00" inputmode="decimal"/></div>
          <div class="field"><label>Lote del Saco</label><input id="f-lote" type="text"/></div>
          <div class="field"><label>Marca del Saco</label><input id="f-marca" type="text"/></div>
          <div class="field"><label>Numeraci√≥n del Saco</label><input id="f-numSaco" type="text"/></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üîÑ Devoluci√≥n</div>
        <div class="fgrid">
          <div class="field"><label>Fecha Devoluci√≥n</label><input id="f-fechaDev" type="date"/></div>
          <div class="field"><label>Sacos Devueltos</label><input id="f-devSacos" type="number" min="0" placeholder="0" inputmode="decimal"/></div>
          <div class="field"><label>KG Devueltos</label><input id="f-devKg" type="number" min="0" step="0.01" placeholder="0.00" inputmode="decimal"/></div>
          <div class="field"><label>Numeraci√≥n Saco Dev.</label><input id="f-devNumSaco" type="text"/></div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üìù Observaciones</div>
        <div class="field"><textarea id="f-obs" placeholder="Observaciones adicionales..."></textarea></div>
      </div>

      <button class="btn btn-primary" id="btn-guardar" onclick="guardarRegistro()">
        ‚úÖ GUARDAR REGISTRO
      </button>
      <div style="height:8px"></div>
    </div>

    <!-- ====== TAB 1: DASHBOARD (admin) ====== -->
    <div id="tab-1" style="display:none">
      <div class="top-bar">
        <div class="page-title">Dashboard</div>
        <button class="btn btn-sm btn-ghost" onclick="cargarTodo()">üîÑ Actualizar</button>
      </div>

      <div class="stats-row">
        <div class="stat-card sc1"><div class="stat-icon">üìã</div><div class="stat-num" id="s-total">0</div><div class="stat-label">Despachos</div></div>
        <div class="stat-card sc2"><div class="stat-icon">üì¶</div><div class="stat-num" id="s-sacos">0</div><div class="stat-label">Sacos</div></div>
        <div class="stat-card sc3"><div class="stat-icon">‚¨ÜÔ∏è</div><div class="stat-num" id="s-kgd">0</div><div class="stat-label">KG Desp.</div></div>
        <div class="stat-card sc4"><div class="stat-icon">‚¨áÔ∏è</div><div class="stat-num" id="s-kgv">0</div><div class="stat-label">KG Dev.</div></div>
        <div class="stat-card sc5"><div class="stat-icon">üî•</div><div class="stat-num" id="s-kgu">0</div><div class="stat-label">KG Usados</div></div>
      </div>

      <div class="charts-grid">
        <div class="chart-card">
          <div class="chart-title">üìä KG Despachados vs Devueltos por Mes</div>
          <div class="chart-wrap"><canvas id="chart-mensual"></canvas></div>
        </div>
        <div class="chart-card">
          <div class="chart-title">üìÖ Sacos por Fecha</div>
          <div class="chart-wrap"><canvas id="chart-sacos"></canvas></div>
        </div>
      </div>
      <div class="charts-grid" style="margin-top:14px">
        <div class="chart-card">
          <div class="chart-title">üìà KG Utilizados Acumulados</div>
          <div class="chart-wrap"><canvas id="chart-acum"></canvas></div>
        </div>
        <div class="chart-card">
          <div class="chart-title">üìç Destinos / Lugares de Pesca</div>
          <div id="chart-destinos" class="destinos-list"></div>
        </div>
      </div>
    </div>

    <!-- ====== TAB 2: REGISTROS (admin) ====== -->
    <div id="tab-2" style="display:none">
      <div class="top-bar">
        <div class="page-title">Registros</div>
        <button class="btn btn-sm btn-ghost" onclick="cargarTodo()">üîÑ</button>
      </div>
      <div class="card">
        <div id="tabla-registros"><div class="empty"><span class="ei">üìã</span>Cargando...</div></div>
      </div>
    </div>

    <!-- ====== TAB 3: REPORTES (admin) ====== -->
    <div id="tab-3" style="display:none">
      <div class="top-bar"><div class="page-title">Reportes</div></div>
      <div class="card">
        <div class="card-title">üîç Filtros</div>
        <div class="filter-grid">
          <div class="field"><label>Desde</label><input id="r-desde" type="date" oninput="aplicarFiltros()"/></div>
          <div class="field"><label>Hasta</label><input id="r-hasta" type="date" oninput="aplicarFiltros()"/></div>
          <div class="field"><label>Conductor</label><input id="r-cond" type="text" placeholder="Buscar..." oninput="aplicarFiltros()"/></div>
          <div class="field"><label>Solicitado Por</label><input id="r-soli" type="text" placeholder="Buscar..." oninput="aplicarFiltros()"/></div>
          <div class="field"><label>Lugar de Pesca</label><input id="r-lugar" type="text" placeholder="Buscar..." oninput="aplicarFiltros()"/></div>
        </div>
        <div style="margin-top:12px"><button class="btn btn-sm btn-ghost" onclick="limpiarFiltros()">‚úï Limpiar</button></div>
      </div>
      <div class="stats-row">
        <div class="stat-card sc1"><div class="stat-num" id="rs-total">0</div><div class="stat-label">Despachos</div></div>
        <div class="stat-card sc2"><div class="stat-num" id="rs-sacos">0</div><div class="stat-label">Sacos</div></div>
        <div class="stat-card sc3"><div class="stat-num" id="rs-kgd">0 kg</div><div class="stat-label">KG Desp.</div></div>
        <div class="stat-card sc4"><div class="stat-num" id="rs-kgv">0 kg</div><div class="stat-label">KG Dev.</div></div>
        <div class="stat-card sc5"><div class="stat-num" id="rs-kgu">0 kg</div><div class="stat-label">KG Usados</div></div>
      </div>
      <div class="card">
        <div class="card-title">üìã Detalle</div>
        <div id="tabla-reporte"><div class="empty"><span class="ei">üîç</span>Aplica filtros</div></div>
      </div>
    </div>

    <!-- ====== TAB 4: USUARIOS (admin) ====== -->
    <div id="tab-4" style="display:none">
      <div class="top-bar"><div class="page-title">Usuarios</div></div>
      <div class="card">
        <div class="card-title">‚ûï Crear Usuario</div>
        <div class="fgrid">
          <div class="field"><label>Nombre completo</label><input id="u-nombre" type="text" placeholder="Nombre"/></div>
          <div class="field"><label>Correo electr√≥nico</label><input id="u-email" type="email" placeholder="correo@empresa.com" inputmode="email"/></div>
          <div class="field"><label>Contrase√±a temporal</label><input id="u-pass" type="text" placeholder="M√≠n. 6 caracteres"/></div>
          <div class="field">
            <label>Rol</label>
            <select id="u-rol">
              <option value="operario">Operario</option>
              <option value="admin">Admin</option>
            </select>
          </div>
        </div>
        <div style="margin-top:14px">
          <button class="btn btn-primary" id="btn-crear" onclick="crearUsuario()" style="max-width:260px">‚ûï CREAR USUARIO</button>
        </div>
      </div>
      <div class="card">
        <div class="card-title">üë• Usuarios Registrados</div>
        <div id="lista-usuarios"><div class="empty">Cargando...</div></div>
      </div>
    </div>


    <!-- ====== TAB 5: KARDEX (admin) ====== -->
    <div id="tab-5" style="display:none">
      <div class="top-bar">
        <div class="page-title">Kardex de Movimientos</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <label class="btn btn-sm btn-warn" style="cursor:pointer">
            üìÇ Importar Excel
            <input type="file" id="k-excel-input" accept=".xlsx,.xls" style="display:none" onchange="importarExcelKardex(this)"/>
          </label>
          <button class="btn btn-sm btn-ghost" onclick="cargarKardex()">&#8635; Actualizar</button>
        </div>
      </div>
      <div id="k-import-status" style="display:none;margin-bottom:10px"></div>

      <!-- Selector de sitio -->
      <div class="card">
        <div class="card-title">Seleccionar Bodega / Sitio</div>
        <div class="fgrid">
          <div class="field" style="grid-column:1/-1">
            <label>Bodega</label>
            <select id="k-sitio" onchange="cargarKardex()" style="background:var(--bg);border:1.5px solid var(--border2);border-radius:10px;padding:11px 13px;color:var(--text);font-size:14px;font-family:inherit;outline:none;width:100%">
              <option value="todos">Todos los sitios (consolidado)</option>
              <option value="LOGIST-Dic 2025">Icemart-Logistica Dic 2025</option>
              <option value="LOGIST-Sta Rosa 2026">Mare Sta. Rosa 2026</option>
              <option value="TELVER-China Resi MARE-STA ROSA">Mare Sta. Rosa 1 - Dic 2025</option>
              <option value="Telver china Resiq MARE CAMBIO">Mare El Cambio</option>
              <option value="CHINA MARE CAMBIO">Icemart-Mare Cambio</option>
              <option value="CHINA-MARE-STA ROSA">Icemart-Mare Sta. Rosa</option>
              <option value="MOLO-LOGIST">Icemart-Logistica Molo</option>
              <option value="CHINA-LOGIST">Icemart-Logistica China</option>
            </select>
          </div>
          <div class="field"><label>Fecha desde</label><input id="k-desde" type="date" oninput="cargarKardex()"/></div>
          <div class="field"><label>Fecha hasta</label><input id="k-hasta" type="date" oninput="cargarKardex()"/></div>
        </div>
      </div>

      <!-- Stats del kardex -->
      <div class="stats-row" id="k-stats" style="display:none">
        <div class="stat-card sc3"><div class="stat-num" id="k-total-ing" style="color:var(--green)">0 kg</div><div class="stat-label">Total Ingresos</div></div>
        <div class="stat-card sc2"><div class="stat-num" id="k-total-egr" style="color:var(--orange)">0 kg</div><div class="stat-label">Total Egresos</div></div>
        <div class="stat-card sc5"><div class="stat-num" id="k-saldo-act" style="color:var(--purple)">0 kg</div><div class="stat-label">Saldo Actual</div></div>
        <div class="stat-card sc1"><div class="stat-num" id="k-movs">0</div><div class="stat-label">Movimientos</div></div>
      </div>

      <!-- Tabla kardex -->
      <div class="card">
        <div id="tabla-kardex"><div class="empty"><span class="ei">&#128196;</span>Selecciona una bodega para ver el kardex</div></div>
      </div>
    </div>

  </div><!-- /main -->

  <!-- BOTTOM NAV -->
  <nav class="bottom-nav" id="bottom-nav">
    <button class="nav-btn active" id="nav-0" onclick="switchTab(0)"><span class="ni">üìã</span>Ingresar</button>
    <!-- admin navs added dynamically -->
  </nav>

</div><!-- /app -->

<!-- MODAL -->
<div class="modal-overlay" id="modal" style="display:none" onclick="if(event.target.id==='modal')closeModal()">
  <div class="modal-box">
    <div class="modal-handle"></div>
    <div class="modal-title" id="modal-title">Detalle</div>
    <div id="modal-body"></div>
    <div style="height:8px"></div>
    <button class="btn btn-ghost btn-sm" onclick="closeModal()" style="width:100%">Cerrar</button>
  </div>
</div>

<!-- MODAL EDITAR REGISTRO -->
<div class="modal-overlay" id="modal-edit" style="display:none" onclick="if(event.target.id==='modal-edit')closeEditModal()">
  <div class="modal-box" style="max-width:700px;max-height:90vh;overflow-y:auto">
    <div class="modal-handle"></div>
    <div class="modal-title">‚úèÔ∏è Editar Registro <span id="edit-num" style="color:var(--cyan)"></span></div>
    <div id="modal-edit-body">
      <!-- Transportista -->
      <div style="font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--cyan);margin:14px 0 10px;display:flex;align-items:center;gap:8px">üöõ Transportista</div>
      <div class="fgrid">
        <div class="field"><label>Conductor</label><input id="e-conductor" type="text"/></div>
        <div class="field"><label>Placa</label><input id="e-placa" type="text"/></div>
        <div class="field"><label>Fecha Inicio</label><input id="e-fechaInicio" type="date"/></div>
        <div class="field"><label>Hora Salida</label><input id="e-horaSalida" type="time"/></div>
        <div class="field"><label>Punto Partida</label><input id="e-puntoPartida" type="text"/></div>
        <div class="field"><label>Fecha Fin</label><input id="e-fechaFin" type="date"/></div>
        <div class="field"><label>Hora Llegada</label><input id="e-horaLlegada" type="time"/></div>
        <div class="field"><label>Punto Llegada</label><input id="e-puntoLlegada" type="text"/></div>
        <div class="field"><label>Ruta</label><input id="e-ruta" type="text"/></div>
        <div class="field"><label>Gu√≠a MDI</label><input id="e-guiaMdi" type="text"/></div>
        <div class="field"><label>Lugar Pesca</label><input id="e-lugarPesca" type="text"/></div>
        <div class="field"><label>Nro. Gu√≠a</label><input id="e-nroGuia" type="text"/></div>
        <div class="field"><label>C√≥d. Recibidor</label><input id="e-codRecibidor" type="text"/></div>
      </div>
      <!-- Despacho -->
      <div style="font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--cyan);margin:14px 0 10px;display:flex;align-items:center;gap:8px">üì¶ Despacho</div>
      <div class="fgrid">
        <div class="field"><label>Fecha Despacho ‚òÖ</label><input id="e-fechaDespacho" type="date"/></div>
        <div class="field"><label>Solicitado Por</label><input id="e-solicitadoPor" type="text"/></div>
        <div class="field"><label>Despachado Por</label><input id="e-despachador" type="text"/></div>
        <div class="field"><label>Cant. Sacos</label><input id="e-cantSacos" type="number" min="0"/></div>
        <div class="field"><label>Cant. KG</label><input id="e-cantKg" type="number" min="0" step="0.01"/></div>
        <div class="field"><label>Lote</label><input id="e-lote" type="text"/></div>
        <div class="field"><label>Marca</label><input id="e-marca" type="text"/></div>
        <div class="field"><label>Num. Saco</label><input id="e-numSaco" type="text"/></div>
      </div>
      <!-- Devolucion -->
      <div style="font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--cyan);margin:14px 0 10px;display:flex;align-items:center;gap:8px">üîÑ Devoluci√≥n</div>
      <div class="fgrid">
        <div class="field"><label>Fecha Dev.</label><input id="e-fechaDev" type="date"/></div>
        <div class="field"><label>Sacos Dev.</label><input id="e-devSacos" type="number" min="0"/></div>
        <div class="field"><label>KG Dev.</label><input id="e-devKg" type="number" min="0" step="0.01"/></div>
        <div class="field"><label>Num. Saco Dev.</label><input id="e-devNumSaco" type="text"/></div>
      </div>
      <!-- Observaciones -->
      <div style="margin-top:12px" class="field"><label>Observaciones</label><textarea id="e-obs"></textarea></div>
    </div>
    <div style="height:14px"></div>
    <div style="display:flex;gap:10px">
      <button class="btn btn-primary" id="btn-guardar-edit" onclick="guardarEdicion()" style="flex:1">üíæ GUARDAR CAMBIOS</button>
      <button class="btn btn-ghost btn-sm" onclick="closeEditModal()" style="min-width:90px">Cancelar</button>
    </div>
    <div style="height:8px"></div>
  </div>
</div>

<!-- PWA SERVICE WORKER INLINE -->
<script>
if('serviceWorker' in navigator){
  const sw=`
    const CACHE='metabisulfito-v1';
    self.addEventListener('install',e=>e.waitUntil(caches.open(CACHE).then(c=>c.addAll(['./','/index.html']))));
    self.addEventListener('fetch',e=>e.respondWith(fetch(e.request).catch(()=>caches.match(e.request))));
  `;
  // SW registration via blob URL not supported in all contexts
  // navigator.serviceWorker.register(URL.createObjectURL(blob));
}
</script>

<!-- FIREBASE -->
<script type="module">
import { initializeApp }   from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc,
         setDoc, getDoc, query, orderBy, updateDoc }
                           from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword,
         signOut, onAuthStateChanged }
                           from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const FB = {
  apiKey:"AIzaSyA8Wvcv3MQNYJT-LNm3UBjG4ta1u-OwrGI",
  authDomain:"lector-qr-25878.firebaseapp.com",
  projectId:"lector-qr-25878",
  storageBucket:"lector-qr-25878.firebasestorage.app",
  messagingSenderId:"8007483133",
  appId:"1:8007483133:web:60b74409d146ad8a0bc894"
};
const fbApp = initializeApp(FB);
const db    = getFirestore(fbApp);
const auth  = getAuth(fbApp);

// Safety fallback: if Firebase never fires onAuthStateChanged within 8s, show login
setTimeout(()=>{
  const ls = document.getElementById('loading-screen');
  if(ls && ls.style.display !== 'none'){
    ls.style.display = 'none';
    const login = document.getElementById('login-screen');
    if(login) login.style.display = 'flex';
  }
}, 8000);
const CDESP = "metabisulfito_despachos";

// ‚îÄ‚îÄ‚îÄ DATOS HIST√ìRICOS DEL EXCEL (embebidos) ‚îÄ‚îÄ‚îÄ
const EXCEL_HISTORICO = [{"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-18", "tipo": "EGRESO", "kg": 150.0, "marca": "China", "lote": "15250220", "numSaco": "1-06", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-19", "tipo": "EGRESO", "kg": 125.0, "marca": "China", "lote": "15250220", "numSaco": "7-10/SN", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-20", "tipo": "EGRESO", "kg": 200.0, "marca": "China/Telver", "lote": "15250220/202508", "numSaco": "11-17/01", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-21", "tipo": "EGRESO", "kg": 425.0, "marca": "Telver", "lote": "202508", "numSaco": "2 al 18", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-22", "tipo": "EGRESO", "kg": 575.0, "marca": "Telver", "lote": "202508", "numSaco": "19 al 41", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-23", "tipo": "EGRESO", "kg": 350.0, "marca": "Telver", "lote": "202508", "numSaco": "42 al 55", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-24", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "48-49", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-24", "tipo": "EGRESO", "kg": 200.0, "marca": "Telver", "lote": "202508", "numSaco": "56 al 63", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-25", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202508", "numSaco": "64 al 75", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-26", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "64-65", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-26", "tipo": "EGRESO", "kg": 1075.0, "marca": "Telver", "lote": "202508", "numSaco": "64-65/48-49/76 al 114", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-27", "tipo": "INGRESO", "kg": 25.0, "marca": "Telver", "lote": "202508", "numSaco": "SR", "docRef": "25", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-27", "tipo": "EGRESO", "kg": 1050.0, "marca": "", "lote": "", "numSaco": "SR/ 115 al 159", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-28", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "SR-SR", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-28", "tipo": "EGRESO", "kg": 450.0, "marca": "Telver", "lote": "202508", "numSaco": "SR-SR-SR/160-175", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-29", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202508", "numSaco": "176 al 187", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-30", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202508", "numSaco": "", "docRef": "150", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-30", "tipo": "EGRESO", "kg": 275.0, "marca": "Telver", "lote": "202508", "numSaco": "", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Dic 2025", "sitio": "Icemart-Logistica Dic 2025", "fecha": "2025-12-31", "tipo": "INGRESO", "kg": 7750.0, "marca": "Telver", "lote": "202509", "numSaco": "891-1200", "docRef": "Transferencia de stock de Mare (fact 001-001-000001542)", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica Dic 2025"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-03", "tipo": "EGRESO", "kg": 675.0, "marca": "", "lote": "202508", "numSaco": "", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-04", "tipo": "EGRESO", "kg": 800.0, "marca": "", "lote": "202508", "numSaco": "", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-05", "tipo": "EGRESO", "kg": 500.0, "marca": "", "lote": "202508", "numSaco": "", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-05", "tipo": "INGRESO", "kg": 425.0, "marca": "Telver", "lote": "202508", "numSaco": "", "docRef": "425", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-06", "tipo": "EGRESO", "kg": 550.0, "marca": "", "lote": "202508", "numSaco": "", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-06", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-07", "tipo": "EGRESO", "kg": 275.0, "marca": "", "lote": "202508", "numSaco": "", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-07", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202508", "numSaco": "", "docRef": "150", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-08", "tipo": "EGRESO", "kg": 250.0, "marca": "", "lote": "202508", "numSaco": "284-293", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-09", "tipo": "EGRESO", "kg": 250.0, "marca": "", "lote": "202508", "numSaco": "294-296", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-10", "tipo": "EGRESO", "kg": 500.0, "marca": "Telver", "lote": "202508", "numSaco": "297 al 308/311 al 318", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-11", "tipo": "EGRESO", "kg": 1150.0, "marca": "Telver/Molo", "lote": "202508/20250615", "numSaco": "309-310/319-352 /01 al 9", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-12", "tipo": "INGRESO", "kg": 300.0, "marca": "Telver/Molo", "lote": "202508", "numSaco": "344 al 352 /01 al 03", "docRef": "300", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-12", "tipo": "EGRESO", "kg": 1200.0, "marca": "Telver/Molo", "lote": "202508/20250615", "numSaco": "344 al 352/01-al 3/10 al 38", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-13", "tipo": "EGRESO", "kg": 325.0, "marca": "Molo", "lote": "20250615", "numSaco": "45 al 57", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-14", "tipo": "EGRESO", "kg": 625.0, "marca": "Molo", "lote": "20250615", "numSaco": "58 al 94", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-15", "tipo": "EGRESO", "kg": 925.0, "marca": "Molo", "lote": "20250615", "numSaco": "95 al 119", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-16", "tipo": "EGRESO", "kg": 550.0, "marca": "Molo", "lote": "20250615", "numSaco": "120 al 141", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-18", "tipo": "INGRESO", "kg": 25.0, "marca": "Molo", "lote": "20250615", "numSaco": "93", "docRef": "25", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-18", "tipo": "EGRESO", "kg": 700.0, "marca": "Molo", "lote": "20250615", "numSaco": "148 al 175", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-19", "tipo": "INGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "174-175", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-19", "tipo": "EGRESO", "kg": 1425.0, "marca": "Molo", "lote": "20250615", "numSaco": "93/142 al 147/174-175/176 al 223", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-20", "tipo": "INGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "206-207", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-21", "tipo": "EGRESO", "kg": 1825.0, "marca": "Molo", "lote": "20250615", "numSaco": "206-207/231 al 242/245 al 252/259 al 309", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-22", "tipo": "EGRESO", "kg": 1875.0, "marca": "Molo", "lote": "20250615", "numSaco": "310-311/224 al 230/243-244/253 al 258/312 al 367/310-311", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-22", "tipo": "INGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "310-311", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-23", "tipo": "EGRESO", "kg": 775.0, "marca": "Molo", "lote": "20250615", "numSaco": "368 al 398", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-24", "tipo": "EGRESO", "kg": 650.0, "marca": "Molo", "lote": "20250615", "numSaco": "399 al 407", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-25", "tipo": "INGRESO", "kg": 250.0, "marca": "Molo", "lote": "20250615", "numSaco": "420 al 424-413 al 417", "docRef": "250", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-26", "tipo": "EGRESO", "kg": 500.0, "marca": "Molo", "lote": "20250615", "numSaco": "420 al 424-413 al 417-425 al 430", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-27", "tipo": "EGRESO", "kg": 600.0, "marca": "Molo", "lote": "20250615", "numSaco": "450-451-435 al439-440 al 449-452 al 459-457-458", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-28", "tipo": "INGRESO", "kg": 150.0, "marca": "Molo", "lote": "20250615", "numSaco": "420-421-423-427-428-429", "docRef": "150", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-28", "tipo": "EGRESO", "kg": 375.0, "marca": "Molo", "lote": "20250615", "numSaco": "459-460-461-462-463-464-465-466-420-421-427-428-429-467-468", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-29", "tipo": "EGRESO", "kg": 900.0, "marca": "Molo", "lote": "20250615", "numSaco": "469-470-423-471 al 477-487-488", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-01-30", "tipo": "EGRESO", "kg": 450.0, "marca": "Telver", "lote": "202509", "numSaco": "894 al 911", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-01", "tipo": "EGRESO", "kg": 200.0, "marca": "Telver", "lote": "202509", "numSaco": "912 al 919", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-02", "tipo": "INGRESO", "kg": 200.0, "marca": "Telver", "lote": "202509", "numSaco": "912 al 919", "docRef": "200", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-03", "tipo": "EGRESO", "kg": 725.0, "marca": "Telver", "lote": "202509", "numSaco": "912 al 940", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-04", "tipo": "EGRESO", "kg": 350.0, "marca": "Telver", "lote": "202509", "numSaco": "941- 954", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-05", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "937 al 940", "docRef": "100", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-05", "tipo": "EGRESO", "kg": 175.0, "marca": "Telver", "lote": "202509", "numSaco": "937 al 939/961-962-963-964", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-08", "tipo": "EGRESO", "kg": 550.0, "marca": "Telver", "lote": "202509", "numSaco": "940/955 al 960/965 al 979", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-09", "tipo": "EGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "980 al 983", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-10", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "980 al 983", "docRef": "100", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-11", "tipo": "EGRESO", "kg": 350.0, "marca": "Telver", "lote": "202509", "numSaco": "980 al 993", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-12", "tipo": "INGRESO", "kg": 16750.0, "marca": "China/ Resiquim", "lote": "612507", "numSaco": "3331-4000", "docRef": "Transferencia de stock de Mare 001-009-000007242 (7406)", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-13", "tipo": "EGRESO", "kg": 625.0, "marca": "Telver", "lote": "202509", "numSaco": "994 al 1018", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-14", "tipo": "EGRESO", "kg": 250.0, "marca": "Telver", "lote": "202509", "numSaco": "1019 al 1028", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-15", "tipo": "EGRESO", "kg": 150.0, "marca": "Telver", "lote": "202509", "numSaco": "1029 al 1034", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-16", "tipo": "EGRESO", "kg": 350.0, "marca": "Telver", "lote": "202509", "numSaco": "1035 al 1048", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-17", "tipo": "EGRESO", "kg": 275.0, "marca": "Telver", "lote": "202509", "numSaco": "1049 al 1059", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-18", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202509", "numSaco": "1035-1036", "docRef": "50", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-18", "tipo": "EGRESO", "kg": 600.0, "marca": "Telver", "lote": "202509", "numSaco": "1035-1036-1060 a 1068/1069 a 1081", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-19", "tipo": "EGRESO", "kg": 450.0, "marca": "Telver", "lote": "202509", "numSaco": "1084 a 1097/1082-1083-1098-1099", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-20", "tipo": "EGRESO", "kg": 375.0, "marca": "Telver", "lote": "202509", "numSaco": "1100-1101/1104-1105/1102-1103-1106-1107/1108-1109/1110 al 1114", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-21", "tipo": "EGRESO", "kg": 200.0, "marca": "Telver", "lote": "202509", "numSaco": "1115 a 1122", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-22", "tipo": "EGRESO", "kg": 750.0, "marca": "Telver", "lote": "202509", "numSaco": "1123 a 1130-1148-1149/1131 a 1147-1150 a 1152", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-23", "tipo": "EGRESO", "kg": 50.0, "marca": "Telver", "lote": "202509", "numSaco": "1153-1154", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-24", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202509", "numSaco": "1155 a 1160/1161-1162/1163-1164/1165-1166", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-25", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202509", "numSaco": "1167 al 1178", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "LOGIST-Sta Rosa 2026", "sitio": "Mare Sta. Rosa 2026", "fecha": "2026-02-26", "tipo": "EGRESO", "kg": 550.0, "marca": "Telver/China", "lote": "202509/612507", "numSaco": "1189 al 1192/1181 al 1185-1195 al 1198/1193 al 1194/1179 al 1180-3331-3332", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 2026"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2025-12-27", "tipo": "EGRESO", "kg": 7500.0, "marca": "", "lote": "202508", "numSaco": "353-652", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2025-12-30", "tipo": "INGRESO", "kg": 30000.0, "marca": "Telver", "lote": "202509", "numSaco": "1-1200", "docRef": "001-001-000001542", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2025-12-31", "tipo": "EGRESO", "kg": 5000.0, "marca": "", "lote": "202509", "numSaco": "1-200", "docRef": "transf a mare cambio", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2025-12-31", "tipo": "EGRESO", "kg": 7750.0, "marca": "", "lote": "202509", "numSaco": "891-1200", "docRef": "transf a log sta rosa 001-001-000001542", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2026-01-21", "tipo": "EGRESO", "kg": 10000.0, "marca": "", "lote": "202509", "numSaco": "201-600", "docRef": "transf a mare cambio(001-009-000007183)", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2026-02-02", "tipo": "INGRESO", "kg": 29775.0, "marca": "China", "lote": "612507", "numSaco": "2810-4000", "docRef": "29775", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2026-02-12", "tipo": "EGRESO", "kg": 7250.0, "marca": "", "lote": "202509", "numSaco": "601-890", "docRef": "transf a mare cambio(001-009-000007246)", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "TELVER-China Resi MARE-STA ROSA", "sitio": "Mare Sta. Rosa 1", "fecha": "2026-02-12", "tipo": "EGRESO", "kg": 16750.0, "marca": "", "lote": "612507", "numSaco": "3331-4000", "docRef": "transf a log sta rosa 001-009-000007242 (7406)", "nroGuia": "", "placa": "", "destino": "Mare Sta. Rosa 1"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-27", "tipo": "INGRESO", "kg": 7500.0, "marca": "Telver", "lote": "202508", "numSaco": "353-652", "docRef": "7500", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-19", "tipo": "EGRESO", "kg": 625.0, "marca": "Telver", "lote": "202508", "numSaco": "653-677", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-20", "tipo": "INGRESO", "kg": 275.0, "marca": "Chino              Telver", "lote": "15250220/ 202508", "numSaco": "13-14-15-16-17/19-20-21-22-23-24", "docRef": "275", "nroGuia": "230-233-224-217-226-221", "placa": "AAA5341-ABE5384-OAA5016-GQZ099-GBO8135-TCM0261", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-20", "tipo": "EGRESO", "kg": 700.0, "marca": "Telver", "lote": "202508", "numSaco": "678-688/751-767", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-22", "tipo": "EGRESO", "kg": 1550.0, "marca": "Telver", "lote": "202508", "numSaco": "689-750", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-23", "tipo": "EGRESO", "kg": 500.0, "marca": "Telver", "lote": "202508", "numSaco": "768-787", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-24", "tipo": "INGRESO", "kg": 625.0, "marca": "Telver", "lote": "202508", "numSaco": "50-51-52-53-54-55-13-14-15-27-29-26-28-34-46-31-33-16-1-25-45-42-43-30-47", "docRef": "625", "nroGuia": "303-301-299-271-286-267-284-276-296-262-265-244-259-03-260-249-", "placa": "OBB3129-OBA1822-LCH0740-OBA3449-AFZ0931-GSY4183-OAA516-AAA7517-ABL5026-OAA1854-LCH0740-OAA5146-OCG0814-LCH0740-AFZ0931-OAA5016", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-24", "tipo": "EGRESO", "kg": 550.0, "marca": "Chino              Telver", "lote": "15250220/ 202508", "numSaco": "13-14-15-16/ 45-25-1-33-31-46-34-28-26-29-27-54-19-20-21-22-23-24", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-26", "tipo": "EGRESO", "kg": 1750.0, "marca": "Telver", "lote": "202508", "numSaco": "788-857", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-26", "tipo": "EGRESO", "kg": 350.0, "marca": "Telver", "lote": "202508", "numSaco": "13-14-15-16-17-50-51-52-53-47-43-42-55-30", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-27", "tipo": "EGRESO", "kg": 2500.0, "marca": "Telver", "lote": "202508", "numSaco": "353-452", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-01-27", "tipo": "INGRESO", "kg": 425.0, "marca": "China", "lote": "15250220", "numSaco": "", "docRef": "425", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-28", "tipo": "INGRESO", "kg": 675.0, "marca": "Telver", "lote": "202508", "numSaco": "96-130-151-150-74-75-149-69-85-86-104-108-49-115-48-109-148-78-116-66-67-106-107-160-163-153-152", "docRef": "675", "nroGuia": "313-322-316-309-328-342-348-332-349-359-373-377-385-364-379", "placa": "TCM0261-OAA1769-OAA1910-OBA1822-PBI6437-AFZ0931-ABL5026-OBA3449-OBA1822-OAA5006-OAA1910-AFZ0931-OAA5016-OCU0545-OAA4374", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-01-29", "tipo": "INGRESO", "kg": 250.0, "marca": "China", "lote": "15250220", "numSaco": "", "docRef": "250", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-29", "tipo": "EGRESO", "kg": 250.0, "marca": "China", "lote": "15250220", "numSaco": "35-44", "docRef": "", "nroGuia": "", "placa": "", "destino": "Devolucion logistica alquilada TRANSCOMAPAC"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-31", "tipo": "INGRESO", "kg": 325.0, "marca": "Telver", "lote": "202508", "numSaco": "174-175-166-167-172-176-177-154-155-170-171-186-188", "docRef": "325", "nroGuia": "397-387-401-391-389-406-411", "placa": "OAA4374-GSY4183-TCM0261-GBO8135-AFZ0931-OAA5146-OAA4374", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2025-12-31", "tipo": "INGRESO", "kg": 5000.0, "marca": "Telver", "lote": "202509", "numSaco": "1-200", "docRef": "5000", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-04", "tipo": "INGRESO", "kg": 275.0, "marca": "Telver", "lote": "202508", "numSaco": "208-169-180-200-199-196-214-215-193-194-195", "docRef": "275", "nroGuia": "443-437-435-440-447-427-430", "placa": "ABE5384-GQZ0299-TCM0261-XBW0304-LCH0740-AFZ0931-PCD9219", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-04", "tipo": "EGRESO", "kg": 225.0, "marca": "Telver", "lote": "202508", "numSaco": "154-155-166-167-172-174-175-176-177", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-05", "tipo": "EGRESO", "kg": 425.0, "marca": "China", "lote": "15250220", "numSaco": "18-34", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-05", "tipo": "EGRESO", "kg": 775.0, "marca": "Telver", "lote": "202508", "numSaco": "85-188-170-171-186-150-153-49-125-104-96-130-67-69-74-149-163-109-116-107-78-84-151-115-86-148-75-106-160-66-108", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-05", "tipo": "EGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "193-195", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-05", "tipo": "EGRESO", "kg": 25.0, "marca": "Telver", "lote": "202508", "numSaco": "196", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area Descabezado"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-06", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202508", "numSaco": "246-241-216-217-198-197", "docRef": "150", "nroGuia": "452-450-468", "placa": "OAA4360-AFZ0931-GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-06", "tipo": "INGRESO", "kg": 175.0, "marca": "Telver", "lote": "202508", "numSaco": "230-231-232-226-227-228-229", "docRef": "175", "nroGuia": "491-496", "placa": "GBO8135-ABE5384", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-06", "tipo": "EGRESO", "kg": 450.0, "marca": "Telver", "lote": "202508", "numSaco": "453 al 470", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-06", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202508", "numSaco": "471 al 482", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-06", "tipo": "EGRESO", "kg": 175.0, "marca": "Telver", "lote": "202508", "numSaco": "483 al 489", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-07", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202508", "numSaco": "271-272-277-278-279-275", "docRef": "150", "nroGuia": "9230-9231", "placa": "GSG7573-PBI6437", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-07", "tipo": "EGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "246-216", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area de procesos"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-08", "tipo": "INGRESO", "kg": 25.0, "marca": "Telver", "lote": "202508", "numSaco": "283", "docRef": "25", "nroGuia": "9235", "placa": "OBA3449", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-08", "tipo": "EGRESO", "kg": 375.0, "marca": "Telver", "lote": "202508", "numSaco": "200-169-215-199-194-180-214-208-275-271-279-277-272-198-217", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-09", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202508", "numSaco": "289-290", "docRef": "50", "nroGuia": "9240", "placa": "AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-09", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202508", "numSaco": "278-231-232-241-197-226-230-227-229-490-491", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-10", "tipo": "INGRESO", "kg": 175.0, "marca": "Telver", "lote": "202508", "numSaco": "298-257-258-236-237-238-239", "docRef": "175", "nroGuia": "9255-9246-9248", "placa": "OAA4374-GBO8135-OAA1854", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-10", "tipo": "EGRESO", "kg": 1250.0, "marca": "Telver", "lote": "202508", "numSaco": "492 al 538/283-289-290", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-11", "tipo": "INGRESO", "kg": 325.0, "marca": "Telver", "lote": "202508", "numSaco": "335-323-320-300-301-302-303-305-307-308-294-295-296", "docRef": "325", "nroGuia": "9282-926992629261", "placa": "OAA1854-TCM0261-LCH0740-GQZ0299", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-11", "tipo": "EGRESO", "kg": 325.0, "marca": "Telver", "lote": "202508", "numSaco": "539 al 551", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-11", "tipo": "EGRESO", "kg": 600.0, "marca": "Telver", "lote": "202508", "numSaco": "552 al 575", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-12", "tipo": "EGRESO", "kg": 325.0, "marca": "Telver", "lote": "202508", "numSaco": "576 al 588", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-13", "tipo": "INGRESO", "kg": 250.0, "marca": "Telver              Molo", "lote": "202508/20250615", "numSaco": "11-13-14-01-344-346-5-6-8-9", "docRef": "250", "nroGuia": "9301-9314-9299", "placa": "LCH0740-OAA1854-GBO8135", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-14", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202508", "numSaco": "346-349-236-237-239-294-238-258-298-296-257-295", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-14", "tipo": "INGRESO", "kg": 75.0, "marca": "Molo", "lote": "20250615", "numSaco": "58-59-65", "docRef": "75", "nroGuia": "9326-9327", "placa": "OAA4374-TCM0261", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-14", "tipo": "INGRESO", "kg": 25.0, "marca": "Molo", "lote": "20250615", "numSaco": "52", "docRef": "25", "nroGuia": "9322", "placa": "AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-14", "tipo": "EGRESO", "kg": 250.0, "marca": "Telver", "lote": "202508", "numSaco": "300-301-303-307-305-323-308-320-335-302", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-14", "tipo": "EGRESO", "kg": 1425.0, "marca": "Telver", "lote": "202508", "numSaco": "589 al 637", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-15", "tipo": "INGRESO", "kg": 100.0, "marca": "Molo", "lote": "20250615", "numSaco": "81-84-79-80", "docRef": "100", "nroGuia": "9350-9344", "placa": "OAA1854-PCD9219", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-15", "tipo": "EGRESO", "kg": 175.0, "marca": "Molo/Telver", "lote": "20250615/202508", "numSaco": "59-58-65-79-80-52-638", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-16", "tipo": "INGRESO", "kg": 150.0, "marca": "Molo", "lote": "20250615", "numSaco": "95-97-98-99-100-119", "docRef": "150", "nroGuia": "9361-9363", "placa": "LCH0740-GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-16", "tipo": "EGRESO", "kg": 150.0, "marca": "Molo", "lote": "20250615", "numSaco": "81-98-97-95-100-99", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-17", "tipo": "INGRESO", "kg": 200.0, "marca": "Molo", "lote": "20250615", "numSaco": "129-130-132-138-135-11-124-125", "docRef": "200", "nroGuia": "9371-9368", "placa": "LCH0740-PCD9219", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-19", "tipo": "INGRESO", "kg": 75.0, "marca": "Molo", "lote": "20250615", "numSaco": "172-173-159", "docRef": "75", "nroGuia": "9388", "placa": "GQZ0299", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-19", "tipo": "INGRESO", "kg": 150.0, "marca": "Molo", "lote": "20250615", "numSaco": "93-177-170-167-168-151", "docRef": "150", "nroGuia": "9384-9380-9376", "placa": "PCD9219-OAA1854-AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-19", "tipo": "INGRESO", "kg": 75.0, "marca": "Molo", "lote": "20250615", "numSaco": "220-223-193", "docRef": "75", "nroGuia": "9399-9391", "placa": "GQZ0299-LCH0740", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-19", "tipo": "EGRESO", "kg": 1500.0, "marca": "Telver", "lote": "202508/202509", "numSaco": "639 al 652/01 al 46", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-19", "tipo": "EGRESO", "kg": 1250.0, "marca": "Telver", "lote": "202509", "numSaco": "47 al 96", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-20", "tipo": "INGRESO", "kg": 100.0, "marca": "Molo", "lote": "20250615", "numSaco": "194-195-204-2025", "docRef": "100", "nroGuia": "9409-9410", "placa": "TCM0261-GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-20", "tipo": "EGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "220-193", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-21", "tipo": "INGRESO", "kg": 100.0, "marca": "Molo", "lote": "20250615", "numSaco": "249-207-181-183", "docRef": "100", "nroGuia": "9428-9422-9392", "placa": "GQZ0299-OAA4374-OAA4374", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-21", "tipo": "INGRESO", "kg": 10000.0, "marca": "Telver", "lote": "202509", "numSaco": "201-600", "docRef": "10000", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-22", "tipo": "EGRESO", "kg": 800.0, "marca": "Telver", "lote": "202509", "numSaco": "97 al 128", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-22", "tipo": "INGRESO", "kg": 150.0, "marca": "Molo", "lote": "20250615", "numSaco": "273-274-275-270-261-263", "docRef": "150", "nroGuia": "9443-9442", "placa": "TCM0261-GBO8135", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-22", "tipo": "INGRESO", "kg": 375.0, "marca": "Molo", "lote": "20250615", "numSaco": "302-303-304-305-306-307-308-309-286-287-276-277-312-284-285", "docRef": "375", "nroGuia": "9459-9457-9454-9447", "placa": "OBA3449-LCH0740-OAA4374-AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-22", "tipo": "INGRESO", "kg": 125.0, "marca": "Molo", "lote": "20250615", "numSaco": "230-323-338-339-340", "docRef": "125", "nroGuia": "9466", "placa": "TCM0261", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-23", "tipo": "INGRESO", "kg": 175.0, "marca": "Molo", "lote": "20250615", "numSaco": "329-326-327-366-367-310-311", "docRef": "175", "nroGuia": "9476-9470", "placa": "GSG7573-PCD9219", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-23", "tipo": "EGRESO", "kg": 400.0, "marca": "Molo", "lote": "20250615", "numSaco": "309-304-306-303-138-173-129-135-125-305-287-285-249-181-183-207", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area de recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-23", "tipo": "EGRESO", "kg": 975.0, "marca": "Molo/Telver", "lote": "20250615/202508", "numSaco": "338-339-340-323-230-275-270-261-274-284-263-312-285-273-132-119-93-204-195-170-159-194-168-205-167-157-223-171-276-277-307-308-124-302-130-172-84-329/11", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-24", "tipo": "INGRESO", "kg": 275.0, "marca": "Molo", "lote": "20250615", "numSaco": "370-375-397-398-385-395-396-389-390-387-388", "docRef": "275", "nroGuia": "9500-9499-9496-9494-9488", "placa": "AFZ0931-PCD9219-TCM0261-LCH0740-OBA3449", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-24", "tipo": "EGRESO", "kg": 25.0, "marca": "Molo", "lote": "20250615", "numSaco": "385", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area descabezado"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-24", "tipo": "EGRESO", "kg": 675.0, "marca": "Molo/Telver", "lote": "20250615/202509", "numSaco": "395-396-387-311-310-388-326-371-370-312/129 al 145", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-25", "tipo": "INGRESO", "kg": 150.0, "marca": "Molo", "lote": "20250615", "numSaco": "404-405-406-407-418-419", "docRef": "150", "nroGuia": "9505", "placa": "GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-26", "tipo": "EGRESO", "kg": 375.0, "marca": "Molo/Telver", "lote": "20250615/202509", "numSaco": "367-366-418-419-407-397-390-406-404-405-398-389/146 al 148", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-27", "tipo": "INGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "431-432", "docRef": "50", "nroGuia": "9518", "placa": "OBA3449", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-27", "tipo": "EGRESO", "kg": 450.0, "marca": "Telver", "lote": "202509", "numSaco": "149 al 166", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-27", "tipo": "EGRESO", "kg": 75.0, "marca": "Molo/Telver", "lote": "20250615/202509", "numSaco": "431-432/167", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-27", "tipo": "INGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "433-434", "docRef": "50", "nroGuia": "9522", "placa": "LCH0740", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-28", "tipo": "INGRESO", "kg": 75.0, "marca": "Molo", "lote": "20250615", "numSaco": "457-458-450", "docRef": "75", "nroGuia": "9529-9530", "placa": "OAA4374-TCM0261", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-28", "tipo": "EGRESO", "kg": 475.0, "marca": "Molo/Telver", "lote": "20250615/202509", "numSaco": "457-458-450-434-433/168 al 181", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-28", "tipo": "INGRESO", "kg": 25.0, "marca": "Molo", "lote": "20250615", "numSaco": "454", "docRef": "25", "nroGuia": "9526", "placa": "GQZ0299", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-28", "tipo": "EGRESO", "kg": 275.0, "marca": "Telver", "lote": "202509", "numSaco": "182 al 192", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-29", "tipo": "INGRESO", "kg": 50.0, "marca": "Molo", "lote": "20250615", "numSaco": "463-464", "docRef": "50", "nroGuia": "9534", "placa": "GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-29", "tipo": "INGRESO", "kg": 100.0, "marca": "Molo", "lote": "20250615", "numSaco": "459-460-461-462", "docRef": "100", "nroGuia": "9535", "placa": "PCD9219", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-29", "tipo": "EGRESO", "kg": 750.0, "marca": "Molo/Telver", "lote": "20250615/202509", "numSaco": "454-459-460-461-462-463-464-/193 al 215", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-29", "tipo": "INGRESO", "kg": 100.0, "marca": "Molo", "lote": "20250615", "numSaco": "465-466-467-468", "docRef": "100", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-30", "tipo": "INGRESO", "kg": 300.0, "marca": "Molo", "lote": "20250615", "numSaco": "478-479-480-481-482-486-491-492-490-499-487-488", "docRef": "300", "nroGuia": "9549-9556-9547-9550", "placa": "AFZ0931-TCM0261-GQZ0299-OBA3449", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-30", "tipo": "EGRESO", "kg": 475.0, "marca": "Molo/Telver", "lote": "20250615/202509", "numSaco": "499-481-482-486-478-490-491-479-467-465-492-466-/216 al 220", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-01-31", "tipo": "INGRESO", "kg": 275.0, "marca": "Telver", "lote": "202509", "numSaco": "907-908-899-895-897-899-905-906-909-910-911", "docRef": "275", "nroGuia": "9560", "placa": "OAA4374", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-02", "tipo": "EGRESO", "kg": 425.0, "marca": "Molo/Telver", "lote": "202509", "numSaco": "911-910-909-908-907-906-905-894-895-897-899-488-487-221-222-223-224", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-04", "tipo": "EGRESO", "kg": 1250.0, "marca": "Telver", "lote": "202509", "numSaco": "225 al 274", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-04", "tipo": "EGRESO", "kg": 1500.0, "marca": "Telver", "lote": "202509", "numSaco": "276 al 335", "docRef": "", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-04", "tipo": "EGRESO", "kg": 25.0, "marca": "Telver", "lote": "202509", "numSaco": "275", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area Tolva"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-04", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202509", "numSaco": "917-919-921-934-935-936", "docRef": "150", "nroGuia": "9574-9585", "placa": "OAA1854-PCD9219", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-05", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202509", "numSaco": "941-942-949-950-951-952", "docRef": "150", "nroGuia": "9575", "placa": "GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-06", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "944-945-948-961", "docRef": "100", "nroGuia": "9628-9611", "placa": "OAA4374-AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-06", "tipo": "EGRESO", "kg": 750.0, "marca": "Telver", "lote": "202509", "numSaco": "941-942-936-934-935-919-917-921-SR (3) / 341 al 357", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-07", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "938-939-963-964", "docRef": "100", "nroGuia": "9633", "placa": "GQZ0299", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-09", "tipo": "INGRESO", "kg": 175.0, "marca": "Telver", "lote": "202509", "numSaco": "974-975-977-955-958-960-957", "docRef": "175", "nroGuia": "9637", "placa": "GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-10", "tipo": "EGRESO", "kg": 500.0, "marca": "Telver", "lote": "202509", "numSaco": "955-975-957-958-977-963-960-974-950-951-945-952-948-961-939-944/358-359-360-361", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-12", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202509", "numSaco": "984-985-987-991-982-983", "docRef": "150", "nroGuia": "9654-9649-9644", "placa": "OAA4374-GQZ0299-AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-12", "tipo": "EGRESO", "kg": 1250.0, "marca": "Telver", "lote": "202509", "numSaco": "938-949-964/362 al 408", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-12", "tipo": "EGRESO", "kg": 25.0, "marca": "Telver", "lote": "202509", "numSaco": "983", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area Tolva"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-12", "tipo": "INGRESO", "kg": 7250.0, "marca": "Telver", "lote": "202509", "numSaco": "601-890", "docRef": "7250", "nroGuia": "", "placa": "", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-14", "tipo": "INGRESO", "kg": 275.0, "marca": "Telver", "lote": "202509", "numSaco": "996-997-998-999-994-995-1000-1009-1013-1014-1016", "docRef": "275", "nroGuia": "9657-9660-9664", "placa": "GSG7573-OAA1854-XBW0304", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-15", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202509", "numSaco": "1025-1028", "docRef": "50", "nroGuia": "9667", "placa": "PIA0438", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-16", "tipo": "INGRESO", "kg": 125.0, "marca": "Telver", "lote": "202509", "numSaco": "1033-1034-1029-1030-1032", "docRef": "125", "nroGuia": "9670-9671", "placa": "LCH0740-OAA4374", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-16", "tipo": "EGRESO", "kg": 600.0, "marca": "Telver", "lote": "202509", "numSaco": "996-997-998-999-994-995-1000-1009-1013-1014-1016-1025-1028/410 al 420", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-17", "tipo": "INGRESO", "kg": 75.0, "marca": "Telver", "lote": "202509", "numSaco": "1037-1038-1040", "docRef": "75", "nroGuia": "9685", "placa": "OAA1854", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-18", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202509", "numSaco": "1052-1059", "docRef": "50", "nroGuia": "9697", "placa": "XBW0304", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-18", "tipo": "EGRESO", "kg": 500.0, "marca": "Telver", "lote": "202509", "numSaco": "987-1033-1034-1029-1030-1032-984-985-982-1038-1037-1040-991/421 al 427", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-19", "tipo": "EGRESO", "kg": 950.0, "marca": "Telver", "lote": "202509", "numSaco": "428 al 465", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-19", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "1060-1061-1067-1036", "docRef": "100", "nroGuia": "9711", "placa": "AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-19", "tipo": "INGRESO", "kg": 150.0, "marca": "Telver", "lote": "202509", "numSaco": "1069-1070-1071-1072-1073-1074", "docRef": "150", "nroGuia": "9710", "placa": "LCH0740", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-19", "tipo": "EGRESO", "kg": 500.0, "marca": "Telver", "lote": "202509", "numSaco": "466 al 485", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-20", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "1082-1083-1098-1099", "docRef": "100", "nroGuia": "9717", "placa": "OAA4374", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-20", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "1091-1092-1093-1088", "docRef": "100", "nroGuia": "9714", "placa": "GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-20", "tipo": "EGRESO", "kg": 50.0, "marca": "Telver", "lote": "202509", "numSaco": "1025-1059", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-20", "tipo": "EGRESO", "kg": 225.0, "marca": "Telver", "lote": "202509", "numSaco": "1060-1061-1067-1036-1069-1070-1071-1072-1074", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-20", "tipo": "EGRESO", "kg": 1350.0, "marca": "Telver", "lote": "202509", "numSaco": "1099-1083-1098-1082/486 hasta 535", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-21", "tipo": "INGRESO", "kg": 175.0, "marca": "Telver", "lote": "202509", "numSaco": "1108-1109-1105-1102-1103-1106-1107", "docRef": "175", "nroGuia": "9791-9733-9727", "placa": "XBW0304-OAA4374-LCH0740", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-21", "tipo": "EGRESO", "kg": 1425.0, "marca": "Telver", "lote": "202509", "numSaco": "1108-1109-1091-1092-1093-1086-1073/536 al 585", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-22", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "1117-1118-1119-1120", "docRef": "100", "nroGuia": "9739-9748", "placa": "GQZ0299-XBW0304", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-23", "tipo": "INGRESO", "kg": 100.0, "marca": "Telver", "lote": "202509", "numSaco": "1129-1130-1132-1144", "docRef": "100", "nroGuia": "9760-9756", "placa": "OAA4374-AFZ0931", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-23", "tipo": "EGRESO", "kg": 200.0, "marca": "Telver", "lote": "202509", "numSaco": "1120-1103-1102-1117-1106-1119-1118-1105", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-24", "tipo": "EGRESO", "kg": 300.0, "marca": "Telver", "lote": "202509", "numSaco": "1129-1130-1144-1132-1107/586 al 592", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-24", "tipo": "EGRESO", "kg": 1100.0, "marca": "Telver", "lote": "202509", "numSaco": "593 al 636", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-24", "tipo": "INGRESO", "kg": 50.0, "marca": "Telver", "lote": "202509", "numSaco": "1161-1162", "docRef": "50", "nroGuia": "9760", "placa": "GSG7573", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-25", "tipo": "INGRESO", "kg": 275.0, "marca": "Telver", "lote": "202509", "numSaco": "1163-1164/1165-1166/1167-1168-1169-1171-1172-1174-1175", "docRef": "275", "nroGuia": "9775-9781-9785", "placa": "GQZ0299-AFZ0931-OAA1854", "destino": "Mare El Cambio"}, {"sheetKey": "Telver china Resiq MARE CAMBIO", "sitio": "Mare El Cambio", "fecha": "2026-02-26", "tipo": "EGRESO", "kg": 275.0, "marca": "Telver", "lote": "202509", "numSaco": "1163-1164/1165-1167-1168-1169-1171-1172-1174-1175/409", "docRef": "", "nroGuia": "", "placa": "", "destino": "Area recepcion"}, {"sheetKey": "CHINA MARE CAMBIO", "sitio": "Icemart-Mare Cambio", "fecha": "2025-12-27", "tipo": "INGRESO", "kg": 425.0, "marca": "CHINA", "lote": "15250220", "numSaco": "18-34", "docRef": "trasf de santa rosa", "nroGuia": "", "placa": "", "destino": "Icemart-Mare Cambio"}, {"sheetKey": "CHINA MARE CAMBIO", "sitio": "Icemart-Mare Cambio", "fecha": "2026-01-05", "tipo": "EGRESO", "kg": 425.0, "marca": "", "lote": "15250220", "numSaco": "18-34", "docRef": "6603", "nroGuia": "", "placa": "", "destino": "Icemart-Mare Cambio"}, {"sheetKey": "CHINA-MARE-STA ROSA", "sitio": "Icemart-Mare Sta. Rosa", "fecha": "2025-12-27", "tipo": "EGRESO", "kg": 425.0, "marca": "", "lote": "15250220", "numSaco": "18-34", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Mare Sta. Rosa"}, {"sheetKey": "CHINA-MARE-STA ROSA", "sitio": "Icemart-Mare Sta. Rosa", "fecha": "2025-12-29", "tipo": "EGRESO", "kg": 250.0, "marca": "", "lote": "15250220", "numSaco": "35-44", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Mare Sta. Rosa"}, {"sheetKey": "CHINA-LOGIST", "sitio": "Icemart-Logistica China", "fecha": "2025-12-18", "tipo": "EGRESO", "kg": 150.0, "marca": "", "lote": "15250220", "numSaco": "1-6", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica China"}, {"sheetKey": "CHINA-LOGIST", "sitio": "Icemart-Logistica China", "fecha": "2025-12-19", "tipo": "EGRESO", "kg": 100.0, "marca": "", "lote": "15250220", "numSaco": "7-10", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica China"}, {"sheetKey": "CHINA-LOGIST", "sitio": "Icemart-Logistica China", "fecha": "2025-12-20", "tipo": "EGRESO", "kg": 175.0, "marca": "", "lote": "15250220", "numSaco": "11-17", "docRef": "", "nroGuia": "", "placa": "", "destino": "Icemart-Logistica China"}];

const CUSR  = "metabisulfito_usuarios";

let curUser=null, curRole=null, curNombre="";
let allReg=[], nextNum=1;
let chartMensual=null, chartSacos=null, chartAcum=null;

// ‚îÄ‚îÄ‚îÄ AUTH STATE ‚îÄ‚îÄ‚îÄ
onAuthStateChanged(auth, async user=>{
  hide("loading-screen");
  if(!user){ show("login-screen","flex"); return; }
  try{
    const snap=await getDoc(doc(db,CUSR,user.uid));
    if(!snap.exists()){ await signOut(auth); showLoginErr("Cuenta no registrada."); show("login-screen","flex"); return; }
    const d=snap.data();
    if(d.activo===false){ await signOut(auth); showLoginErr("Cuenta desactivada. Contacta al admin."); show("login-screen","flex"); return; }
    curUser=user; curRole=d.rol; curNombre=d.nombre||user.email;
    initApp();
  }catch(e){ hide("loading-screen"); show("login-screen","flex"); showLoginErr("Error: "+e.message); }
});

// ‚îÄ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ‚îÄ
window.doLogin=async function(){
  const email=g("l-email").value.trim(), pass=g("l-pass").value;
  if(!email||!pass){showLoginErr("Ingresa correo y contrase√±a.");return;}
  const btn=g("btn-login"); btn.disabled=true; btn.innerHTML='<span class="spinner"></span> Ingresando...';
  g("lerror").style.display="none";
  try{ await signInWithEmailAndPassword(auth,email,pass); }
  catch(e){
    let m="Correo o contrase√±a incorrectos.";
    if(e.code==="auth/too-many-requests") m="Demasiados intentos. Espera unos minutos.";
    showLoginErr(m); btn.disabled=false; btn.textContent="INGRESAR AL SISTEMA";
  }
};
window.doLogout=async function(){
  await signOut(auth); curUser=curRole=null; allReg=[];
  hide("app-screen"); show("login-screen","flex");
};

// ‚îÄ‚îÄ‚îÄ INIT APP ‚îÄ‚îÄ‚îÄ
async function initApp(){
  hide("login-screen"); show("app-screen","block");
  g("h-user-name").textContent=curNombre;
  const rb=g("h-role"); rb.textContent=curRole;
  rb.className="rbadge "+(curRole==="admin"?"rbadge-admin":"rbadge-operario");
  // Build nav
  const nav=g("bottom-nav");
  if(curRole==="admin"){
    nav.innerHTML=`
      <button class="nav-btn active" id="nav-0" onclick="switchTab(0)"><span class="ni" style="font-size:16px">&#9998;</span>Ingresar</button>
      <button class="nav-btn" id="nav-1" onclick="switchTab(1)"><span class="ni" style="font-size:16px">&#9650;</span>Panel</button>
      <button class="nav-btn" id="nav-2" onclick="switchTab(2)"><span class="ni" style="font-size:16px">&#9776;</span>Registros</button>
      <button class="nav-btn" id="nav-3" onclick="switchTab(3)"><span class="ni" style="font-size:16px">&#9654;</span>Reportes</button>
      <button class="nav-btn" id="nav-5" onclick="switchTab(5)"><span class="ni" style="font-size:16px">&#9783;</span>Kardex</button>
      <button class="nav-btn" id="nav-4" onclick="switchTab(4)"><span class="ni" style="font-size:16px">&#9786;</span>Usuarios</button>`;  } else {
    nav.innerHTML=`<button class="nav-btn active" id="nav-0" onclick="switchTab(0)"><span class="ni" style="font-size:16px">&#9998;</span>Ingresar</button>`;  }
  switchTab(0);
  await cargarTodo();
}

// ‚îÄ‚îÄ‚îÄ CARGAR DATOS ‚îÄ‚îÄ‚îÄ
window.cargarTodo=async function(){
  try{
    const q=query(collection(db,CDESP),orderBy("createdAt","desc"));
    const snap=await getDocs(q);
    allReg=snap.docs.map(d=>({id:d.id,...d.data()}));
    nextNum=allReg.length>0?Math.max(...allReg.map(r=>parseInt(r.numeracion)||0))+1:1;
    g("next-num").textContent=String(nextNum).padStart(5,"0");
    if(curRole==="admin"){
      renderDashboard();
      renderTabla();
      aplicarFiltros();
      cargarUsuarios();
    }
  }catch(e){ showAlert("Error al cargar: "+e.message,"error"); }
};

// ‚îÄ‚îÄ‚îÄ GUARDAR ‚îÄ‚îÄ‚îÄ
window.guardarRegistro=async function(){
  const conductorRaw=v("f-conductor");
    const conductor = conductorRaw==="OTRO" ? v("f-conductor-manual") : conductorRaw;
    const fechaDespacho=v("f-fechaDespacho");
  if(!conductor||!fechaDespacho){showAlert("Faltan campos obligatorios: Conductor ‚òÖ y Fecha del Despacho ‚òÖ","error");return;}
  const btn=g("btn-guardar"); btn.disabled=true; btn.innerHTML='<span class="spinner"></span> Guardando en Firebase...';
  try{
    const reg={
      numeracion:String(nextNum).padStart(5,"0"),
      ingresadoPor:curNombre, ingresadoPorUid:curUser.uid,
      placa:v("f-placa"), conductor, fechaInicio:v("f-fechaInicio"),
      horaSalida:v("f-horaSalida"), puntoPartida:v("f-puntoPartida"),
      fechaFin:v("f-fechaFin"), horaLlegada:v("f-horaLlegada"),
      puntoLlegada:v("f-puntoLlegada"), ruta:v("f-ruta"),
      guiaMdi:v("f-guiaMdi"), lugarPesca:v("f-lugarPesca"),
      nroGuia:v("f-nroGuia"), codRecibidor:v("f-codRecibidor"),
      fechaDespacho, solicitadoPor:v("f-solicitadoPor"),
      despachador:v("f-despachador"),
      cantSacos:parseFloat(v("f-cantSacos"))||0,
      cantKg:parseFloat(v("f-cantKg"))||0,
      lote:v("f-lote"), marca:v("f-marca"), numSaco:v("f-numSaco"),
      fechaDev:v("f-fechaDev"),
      devSacos:parseFloat(v("f-devSacos"))||0,
      devKg:parseFloat(v("f-devKg"))||0,
      devNumSaco:v("f-devNumSaco"), observacion:v("f-obs"),
      createdAt:new Date().toISOString()
    };
    await addDoc(collection(db,CDESP),reg);
    generarPDF(reg);
    limpiarForm();
    await cargarTodo();
    showAlert("‚úÖ Registro N¬∞ "+reg.numeracion+" guardado. PDF generado autom√°ticamente.","success");
  }catch(e){ showAlert("Error: "+e.message,"error"); }
  btn.disabled=false; btn.textContent="‚úÖ GUARDAR REGISTRO";
};

// ‚îÄ‚îÄ‚îÄ ELIMINAR ‚îÄ‚îÄ‚îÄ
window.eliminarRegistro=async function(id){
  if(!confirm("¬øEliminar este registro?")) return;
  try{ await deleteDoc(doc(db,CDESP,id)); await cargarTodo(); showAlert("Registro eliminado.","info"); }
  catch(e){ showAlert("Error: "+e.message,"error"); }
};

// ‚îÄ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ‚îÄ

// Combina Firebase + Excel hist√≥rico en un array unificado para el dashboard
function allRegConHistorico(){
  // Convertir EXCEL_HISTORICO al mismo formato que allReg para poder mezclarlos
  const excelComoReg = EXCEL_HISTORICO.map(e => ({
    fechaDespacho: e.fecha,
    cantKg:  e.tipo === "EGRESO"  ? e.kg : 0,
    devKg:   e.tipo === "INGRESO" ? e.kg : 0,
    cantSacos: 0,
    lugarPesca: e.destino || e.sitio,
    conductor: e.conductor || "",
    _fromExcel: true,
  }));
  return [...allReg, ...excelComoReg];
}

function renderDashboard(){
  const todos = allRegConHistorico();
  const tkd=todos.reduce((s,r)=>s+(r.cantKg||0),0);
  const tkv=todos.reduce((s,r)=>s+(r.devKg||0),0);
  const ts=todos.reduce((s,r)=>s+(r.cantSacos||0),0);
  // Despachos: Firebase tiene registros completos, Excel tiene movimientos individuales
  const totalDespachos = allReg.length + EXCEL_HISTORICO.filter(e=>e.tipo==="EGRESO").length;
  g("s-total").textContent=totalDespachos;
  g("s-sacos").textContent=ts||"‚Äî";
  g("s-kgd").textContent=tkd.toFixed(1)+" kg";
  g("s-kgv").textContent=tkv.toFixed(1)+" kg";
  g("s-kgu").textContent=(tkd-tkv).toFixed(1)+" kg";
  buildChartMensual(); buildChartSacos(); buildChartAcum(); buildDestinos();
}

function buildChartMensual(){
  const todos = allRegConHistorico();
  const map={};
  todos.forEach(r=>{
    if(!r.fechaDespacho) return;
    const k=r.fechaDespacho.slice(0,7);
    if(!map[k]) map[k]={d:0,v:0};
    map[k].d+=r.cantKg||0; map[k].v+=r.devKg||0;
  });
  const labels=Object.keys(map).sort().slice(-8);
  const desp=labels.map(k=>+map[k].d.toFixed(1));
  const dev=labels.map(k=>+map[k].v.toFixed(1));
  const ctx=g("chart-mensual").getContext("2d");
  if(chartMensual) chartMensual.destroy();
  chartMensual=new Chart(ctx,{
    type:"bar",
    data:{labels:labels.map(l=>{ const[y,m]=l.split("-"); return["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"][parseInt(m)-1]+"/"+y.slice(2); }),
      datasets:[
        {label:"KG Despachados",data:desp,backgroundColor:"#3b9eff88",borderColor:"#3b9eff",borderWidth:2,borderRadius:6},
        {label:"KG Devueltos",data:dev,backgroundColor:"#10e89a88",borderColor:"#10e89a",borderWidth:2,borderRadius:6}
      ]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:"#7a9bb5",font:{size:10}}}},scales:{x:{ticks:{color:"#7a9bb5",font:{size:10}},grid:{color:"#1f3347"}},y:{ticks:{color:"#7a9bb5",font:{size:10}},grid:{color:"#1f3347"}}}}
  });
}

function buildChartSacos(){
  // Sacos solo de Firebase (el Excel no tiene datos de sacos individuales)
  const map={};
  allReg.forEach(r=>{ if(!r.fechaDespacho) return; map[r.fechaDespacho]=(map[r.fechaDespacho]||0)+(r.cantSacos||0); });
  const labels=Object.keys(map).sort().slice(-10);
  const data=labels.map(k=>map[k]);
  const ctx=g("chart-sacos").getContext("2d");
  if(chartSacos) chartSacos.destroy();
  chartSacos=new Chart(ctx,{
    type:"line",
    data:{labels,datasets:[{label:"Sacos (Firebase)",data,fill:true,backgroundColor:"#a78bfa22",borderColor:"#a78bfa",borderWidth:2,tension:.4,pointBackgroundColor:"#a78bfa",pointRadius:4}]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:"#7a9bb5",font:{size:10}}}},scales:{x:{ticks:{color:"#7a9bb5",font:{size:9},maxRotation:40},grid:{color:"#1f3347"}},y:{ticks:{color:"#7a9bb5",font:{size:10}},grid:{color:"#1f3347"}}}}
  });
}

function buildChartAcum(){
  // Acumulado de KG combinando Excel hist√≥rico + Firebase, ordenado por fecha
  const todos = allRegConHistorico();
  const sorted=todos.filter(r=>r.fechaDespacho).sort((a,b)=>a.fechaDespacho.localeCompare(b.fechaDespacho));
  let acum=0;
  const labels=[], data=[];
  sorted.forEach(r=>{
    acum+=(r.cantKg||0)-(r.devKg||0);
    labels.push(r.fechaDespacho);
    data.push(+acum.toFixed(1));
  });
  const ctx=g("chart-acum").getContext("2d");
  if(chartAcum) chartAcum.destroy();
  chartAcum=new Chart(ctx,{
    type:"line",
    data:{labels:labels.slice(-30),datasets:[{label:"KG Neto Acumulado",data:data.slice(-30),fill:true,backgroundColor:"#ff8c4222",borderColor:"#ff8c42",borderWidth:2,tension:.4,pointRadius:2,pointBackgroundColor:"#ff8c42"}]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:"#7a9bb5",font:{size:10}}}},scales:{x:{ticks:{color:"#7a9bb5",font:{size:9},maxRotation:40},grid:{color:"#1f3347"}},y:{ticks:{color:"#7a9bb5",font:{size:10}},grid:{color:"#1f3347"}}}}
  });
}

function buildDestinos(){
  const todos = allRegConHistorico();
  const map={};
  todos.forEach(r=>{ if(r.lugarPesca) map[r.lugarPesca]=(map[r.lugarPesca]||0)+1; });
  const sorted=Object.entries(map).sort((a,b)=>b[1]-a[1]).slice(0,8);
  const max=sorted[0]?.[1]||1;
  const wrap=g("chart-destinos");
  if(!sorted.length){ wrap.innerHTML='<div class="empty" style="padding:20px">Sin datos de destinos</div>'; return; }
  wrap.innerHTML=sorted.map(([n,c])=>`
    <div class="destino-row">
      <div class="destino-name">${n}</div>
      <div class="destino-bar-wrap"><div class="destino-bar" style="width:${(c/max*100).toFixed(0)}%"></div></div>
      <div class="destino-count">${c} desp.</div>
    </div>`).join("");
}

// ‚îÄ‚îÄ‚îÄ RENDER TABLA ‚îÄ‚îÄ‚îÄ
function renderTabla(){
  const wrap=g("tabla-registros");
  if(!allReg.length){ wrap.innerHTML='<div class="empty"><span class="ei">üìã</span>Sin registros a√∫n</div>'; return; }
  wrap.innerHTML=`<div class="tbl-wrap"><table>
    <thead><tr><th>N¬∞</th><th>Fecha</th><th>Conductor</th><th>Placa</th><th>Lugar Pesca</th><th>Sacos</th><th>KG D.</th><th>KG Dev.</th><th>Por</th><th>Acc.</th></tr></thead>
    <tbody>${allReg.map(r=>`<tr>
      <td><span class="badge b-blue">${r.numeracion}</span></td>
      <td style="white-space:nowrap">${r.fechaDespacho||"‚Äî"}</td>
      <td>${r.conductor||"‚Äî"}</td><td>${r.placa||"‚Äî"}</td>
      <td>${r.lugarPesca||"‚Äî"}</td><td>${r.cantSacos||"‚Äî"}</td>
      <td>${r.cantKg?r.cantKg+" kg":"‚Äî"}</td>
      <td>${r.devKg?'<span class="badge b-green">'+r.devKg+' kg</span>':'<span style="color:var(--muted)">‚Äî</span>'}</td>
      <td style="font-size:11px;color:var(--muted)">${r.ingresadoPor||"‚Äî"}</td>
      <td><div class="act">
        <button class="btn btn-sm btn-info" onclick="verDetalle('${r.id}')">Ver</button>
        <button class="btn btn-sm btn-success" onclick="editarRegistro('${r.id}')">‚úèÔ∏è Editar</button>
        <button class="btn btn-sm btn-info" onclick="pdfRegistro('${r.id}')">PDF</button>
        <button class="btn btn-sm btn-danger" onclick="eliminarRegistro('${r.id}')">üóë</button>
      </div></td>
    </tr>`).join("")}
    </tbody></table></div>`;
}

// ‚îÄ‚îÄ‚îÄ FILTROS ‚îÄ‚îÄ‚îÄ
window.aplicarFiltros=function(){
  const desde=g("r-desde").value, hasta=g("r-hasta").value;
  const cond=g("r-cond").value.toLowerCase(), soli=g("r-soli").value.toLowerCase(), lugar=g("r-lugar").value.toLowerCase();
  const f=allReg.filter(r=>{
    if(desde&&r.fechaDespacho<desde) return false;
    if(hasta&&r.fechaDespacho>hasta) return false;
    if(cond&&!(r.conductor||"").toLowerCase().includes(cond)) return false;
    if(soli&&!(r.solicitadoPor||"").toLowerCase().includes(soli)) return false;
    if(lugar&&!(r.lugarPesca||"").toLowerCase().includes(lugar)) return false;
    return true;
  });
  const tkd=f.reduce((s,r)=>s+(r.cantKg||0),0);
  const tkv=f.reduce((s,r)=>s+(r.devKg||0),0);
  const ts=f.reduce((s,r)=>s+(r.cantSacos||0),0);
  g("rs-total").textContent=f.length; g("rs-sacos").textContent=ts;
  g("rs-kgd").textContent=tkd.toFixed(1)+" kg"; g("rs-kgv").textContent=tkv.toFixed(1)+" kg"; g("rs-kgu").textContent=(tkd-tkv).toFixed(1)+" kg";
  const wrap=g("tabla-reporte");
  if(!f.length){wrap.innerHTML='<div class="empty"><span class="ei">üîç</span>Sin resultados</div>';return;}
  wrap.innerHTML=`<div class="tbl-wrap"><table>
    <thead><tr><th>N¬∞</th><th>Fecha</th><th>Conductor</th><th>Lugar Pesca</th><th>Sol. Por</th><th>Sacos</th><th>KG D.</th><th>KG Dev.</th><th>KG Usado</th></tr></thead>
    <tbody>${f.map(r=>{const u=(r.cantKg||0)-(r.devKg||0);return`<tr>
      <td><span class="badge b-blue">${r.numeracion}</span></td>
      <td>${r.fechaDespacho||"‚Äî"}</td><td>${r.conductor||"‚Äî"}</td>
      <td>${r.lugarPesca||"‚Äî"}</td><td>${r.solicitadoPor||"‚Äî"}</td>
      <td>${r.cantSacos||"‚Äî"}</td><td>${r.cantKg?r.cantKg+" kg":"‚Äî"}</td>
      <td>${r.devKg?r.devKg+" kg":"‚Äî"}</td>
      <td><span class="badge b-pink">${u.toFixed(1)} kg</span></td>
    </tr>`}).join("")}
    </tbody>
    <tfoot><tr><td colspan="5" style="color:var(--muted)">TOTALES</td>
      <td>${ts}</td><td style="color:var(--orange)">${tkd.toFixed(1)} kg</td>
      <td style="color:var(--green)">${tkv.toFixed(1)} kg</td>
      <td style="color:var(--pink)">${(tkd-tkv).toFixed(1)} kg</td>
    </tr></tfoot></table></div>`;
};
window.limpiarFiltros=function(){
  ["r-desde","r-hasta","r-cond","r-soli","r-lugar"].forEach(id=>g(id).value="");
  aplicarFiltros();
};

// ‚îÄ‚îÄ‚îÄ VER DETALLE ‚îÄ‚îÄ‚îÄ
window.verDetalle=function(id){
  const r=allReg.find(x=>x.id===id); if(!r) return;
  g("modal-title").textContent="Orden de Despacho N¬∞ "+r.numeracion;
  const f=(l,val)=>val?`<div class="det-row"><div class="det-lbl">${l}</div><div class="det-val">${val}</div></div>`:"";
  g("modal-body").innerHTML=`
    <div class="det-sec"><div class="det-title">üöõ Transportista</div><div class="det-grid">
      ${f("Placa",r.placa)}${f("Conductor",r.conductor)}
      ${f("F. Inicio",r.fechaInicio)}${f("H. Salida",r.horaSalida)}
      ${f("Punto Partida",r.puntoPartida)}${f("F. Fin",r.fechaFin)}
      ${f("H. Llegada",r.horaLlegada)}${f("Punto Llegada",r.puntoLlegada)}
      ${f("Ruta",r.ruta)}${f("Gu√≠a MDI",r.guiaMdi)}
      ${f("Lugar Pesca",r.lugarPesca)}${f("Nro. Gu√≠a",r.nroGuia)}
      ${f("C√≥d. Recibidor",r.codRecibidor)}
    </div></div>
    <div class="det-sec"><div class="det-title">üì¶ Despacho</div><div class="det-grid">
      ${f("Fecha",r.fechaDespacho)}${f("Solicitado Por",r.solicitadoPor)}
      ${f("Despachado Por",r.despachador)}${f("Sacos",r.cantSacos)}
      ${f("KG",r.cantKg?r.cantKg+" kg":"")}${f("Lote",r.lote)}
      ${f("Marca",r.marca)}${f("Num. Saco",r.numSaco)}
    </div></div>
    <div class="det-sec"><div class="det-title">üîÑ Devoluci√≥n</div><div class="det-grid">
      ${f("Fecha",r.fechaDev)}${f("Sacos",r.devSacos)}
      ${f("KG",r.devKg?r.devKg+" kg":"")}${f("Num. Saco",r.devNumSaco)}
    </div></div>
    ${r.observacion?`<div class="det-sec"><div class="det-title">üìù Observaciones</div><div style="font-size:13px">${r.observacion}</div></div>`:""}
    <div style="margin-top:12px"><button class="btn btn-info" style="width:100%" onclick="pdfRegistro('${r.id}')">üìÑ Generar PDF</button></div>
    <div style="font-size:11px;color:var(--muted);margin-top:10px;text-align:center">Ingresado por: ${r.ingresadoPor||"‚Äî"}</div>`;
  g("modal").style.display="flex";
};
window.closeModal=()=>g("modal").style.display="none";

// ‚îÄ‚îÄ‚îÄ PDF (igual a FOR-BOD-05) ‚îÄ‚îÄ‚îÄ
window.pdfRegistro=function(id){
  const r=typeof id==="string"?allReg.find(x=>x.id===id):id;
  if(!r) return;
  generarPDF(r);
};

function limpiar(str){
  if(!str && str!==0) return "-";
  return String(str)
    .replace(/[√°√†√§]/g,"a").replace(/[√Å√Ä√Ñ]/g,"A")
    .replace(/[√©√®√´]/g,"e").replace(/[√â√à√ã]/g,"E")
    .replace(/[√≠√¨√Ø]/g,"i").replace(/[√ç√å√è]/g,"I")
    .replace(/[√≥√≤√∂]/g,"o").replace(/[√ì√í√ñ]/g,"O")
    .replace(/[√∫√π√º]/g,"u").replace(/[√ö√ô√ú]/g,"U")
    .replace(/√±/g,"n").replace(/√ë/g,"N")
    .replace(/[^\x20-\x7E]/g,"");
}

function generarPDF(r){
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF({orientation:"portrait",unit:"mm",format:"a4"});
  const W=210, M=14, CW=W-M*2;

  // ‚îÄ‚îÄ Paleta MARECUADOR ‚îÄ‚îÄ
  const AZUL_OSC  = [13,  32,  53 ];
  const AZUL_MED  = [29,  111, 168];
  const AZUL_ACA  = [6,   174, 212];
  const GRIS_FILA = [246, 248, 251];
  const GRIS_ALT  = [240, 244, 248];
  const GRIS_LBL  = [100, 120, 145];
  const NEGRO     = [30,  30,  30 ];
  const BLANCO    = [255, 255, 255];
  const BORDE_C   = [200, 215, 228];
  const VERDE     = [16,  185, 122];
  const AMARILLO  = [255, 193, 7  ];

  let y = 0;

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ENCABEZADO FORMAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // Fondo azul oscuro completo
  doc.setFillColor(...AZUL_OSC);
  doc.rect(0, 0, W, 46, "F");
  // Franja acento izquierda
  doc.setFillColor(...AZUL_ACA);
  doc.rect(0, 0, 5, 46, "F");
  // L√≠nea inferior del header
  doc.setFillColor(...AZUL_MED);
  doc.rect(0, 46, W, 1.5, "F");

  // Logo MARECUADOR (PNG base64)
  try{
    const logoData = "data:image/png;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB/9k=";
    doc.addImage(logoData, "PNG", 8, 5, 52, 14);
  }catch(e){}

  // Nombre empresa + subt√≠tulo
  doc.setFont("helvetica","bold");
  doc.setFontSize(7);
  doc.setTextColor(150, 185, 210);
  doc.text("MARECUADOR CIA. LTDA.", 8, 24);
  doc.setFont("helvetica","normal");
  doc.setFontSize(6.5);
  doc.setTextColor(120, 160, 190);
  doc.text("Bodega Sta. Rosa  |  Control de Insumos Qu√≠micos", 8, 29);
  doc.setFontSize(6);
  doc.setTextColor(100, 140, 170);
  const fechaReg = new Date(r.createdAt||Date.now());
  const fechaStr = fechaReg.getDate()+"/"+(fechaReg.getMonth()+1)+"/"+fechaReg.getFullYear()+" "+fechaReg.getHours()+":"+String(fechaReg.getMinutes()).padStart(2,"0");
  doc.text("Ingresado por: "+limpiar(r.ingresadoPor)+"   |   Registro: "+fechaStr, 8, 34);

  // Bloque derecho ‚Äî c√≥digo y numeraci√≥n
  doc.setFont("helvetica","bold");
  doc.setFontSize(6.5);
  doc.setTextColor(...AZUL_ACA);
  doc.text("C√ìDIGO: FOR-BOD-05", W-M, 9, {align:"right"});
  doc.text("VERSI√ìN: 00", W-M, 14, {align:"right"});
  doc.text("EMISI√ìN: 10/02/2026", W-M, 19, {align:"right"});

  // T√≠tulo del documento centrado en bloque derecho
  doc.setFont("helvetica","bold");
  doc.setFontSize(8.5);
  doc.setTextColor(...BLANCO);
  doc.text("ORDEN DE DESPACHO", W-M, 28, {align:"right"});
  doc.setFont("helvetica","normal");
  doc.setFontSize(7);
  doc.setTextColor(180, 210, 230);
  doc.text("METABISULFITO DE SODIO", W-M, 33, {align:"right"});

  // N√∫mero de orden ‚Äî destacado
  doc.setFillColor(...AZUL_MED);
  doc.roundedRect(W-M-32, 37, 33, 7, 1.5, 1.5, "F");
  doc.setFont("helvetica","bold");
  doc.setFontSize(9);
  doc.setTextColor(...BLANCO);
  doc.text("No. "+limpiar(r.numeracion), W-M-16, 42.5, {align:"center"});

  y = 52;

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FUNCIONES INTERNAS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  function seccion(titulo, color){
    const bg = color || AZUL_MED;
    doc.setFillColor(...bg);
    doc.rect(M, y, CW, 7, "F");
    doc.setFillColor(...AZUL_ACA);
    doc.rect(M, y, 3.5, 7, "F");
    doc.setFont("helvetica","bold");
    doc.setFontSize(7.5);
    doc.setTextColor(...BLANCO);
    doc.text(titulo, M+7, y+5);
    y += 8.5;
  }

  let filaAlterna = false;
  function fila2(l1, v1, l2, v2){
    const col = filaAlterna ? GRIS_ALT : GRIS_FILA;
    filaAlterna = !filaAlterna;
    doc.setFillColor(...col);
    doc.rect(M, y, CW, 9, "F");
    doc.setDrawColor(...BORDE_C);
    doc.setLineWidth(0.15);
    doc.rect(M, y, CW, 9, "S");
    doc.line(M+CW/2, y, M+CW/2, y+9);
    const c1 = M+3.5, c2 = M+CW/2+3.5;
    doc.setFont("helvetica","bold"); doc.setFontSize(5.5); doc.setTextColor(...GRIS_LBL);
    doc.text(l1, c1, y+3);
    doc.setFont("helvetica","normal"); doc.setFontSize(8.5); doc.setTextColor(...NEGRO);
    doc.text(limpiar(v1), c1, y+7.8);
    if(l2){
      doc.setFont("helvetica","bold"); doc.setFontSize(5.5); doc.setTextColor(...GRIS_LBL);
      doc.text(l2, c2, y+3);
      doc.setFont("helvetica","normal"); doc.setFontSize(8.5); doc.setTextColor(...NEGRO);
      doc.text(limpiar(v2), c2, y+7.8);
    }
    y += 9.5;
  }

  function fila1(l, val){
    const col = filaAlterna ? GRIS_ALT : GRIS_FILA;
    filaAlterna = !filaAlterna;
    doc.setFillColor(...col);
    doc.rect(M, y, CW, 9, "F");
    doc.setDrawColor(...BORDE_C);
    doc.setLineWidth(0.15);
    doc.rect(M, y, CW, 9, "S");
    doc.setFont("helvetica","bold"); doc.setFontSize(5.5); doc.setTextColor(...GRIS_LBL);
    doc.text(l, M+3.5, y+3);
    doc.setFont("helvetica","normal"); doc.setFontSize(8.5); doc.setTextColor(...NEGRO);
    doc.text(limpiar(val), M+3.5, y+7.8);
    y += 9.5;
  }

  function filaDestacada(label, valor, colorVal){
    doc.setFillColor(...AZUL_OSC);
    doc.rect(M, y, CW, 11, "F");
    doc.setFillColor(...AZUL_ACA);
    doc.rect(M, y, 3.5, 11, "F");
    doc.setFont("helvetica","bold"); doc.setFontSize(6.5); doc.setTextColor(160, 200, 220);
    doc.text(label, M+7, y+4.5);
    doc.setFontSize(12); doc.setTextColor(...(colorVal||BLANCO));
    doc.text(limpiar(valor), M+7, y+10);
    y += 13;
  }

  function espacio(n){ y += n||5; }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECCIONES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

  // ‚îÄ‚îÄ TRANSPORTISTA ‚îÄ‚îÄ
  filaAlterna = false;
  seccion("üöõ  INFORMACI√ìN DEL TRANSPORTISTA");
  fila2("PLACA DEL VEH√çCULO",         r.placa,       "NOMBRE DEL CONDUCTOR",     r.conductor);
  fila2("FECHA INICIO TRANSPORTE",    r.fechaInicio, "HORA DE SALIDA",            r.horaSalida);
  fila2("PUNTO DE PARTIDA",           r.puntoPartida,"FECHA FIN TRANSPORTE",      r.fechaFin);
  fila2("HORA DE LLEGADA",            r.horaLlegada, "PUNTO DE LLEGADA",          r.puntoLlegada);
  fila2("RUTA DEL TRANSPORTE",        r.ruta,        "GU√çA MDI",                  r.guiaMdi);
  fila2("LUGAR DE PESCA / PRODUCTOR", r.lugarPesca,  "NRO. GU√çA REMISI√ìN / PESCA",r.nroGuia);
  fila1("C√ìDIGO RECIBIDOR",           r.codRecibidor);
  espacio(3);

  // ‚îÄ‚îÄ DESPACHO ‚îÄ‚îÄ
  filaAlterna = false;
  seccion("üì¶  DESPACHO DE METABISULFITO DE SODIO PARA LA PESCA");
  fila2("FECHA DEL DESPACHO",  r.fechaDespacho,  "SOLICITADO POR",      r.solicitadoPor);
  fila2("DESPACHADO POR",      r.despachador,    "COD. RECIBIDOR",      r.codRecibidor);
  fila2("CANTIDAD DE SACOS",   String(r.cantSacos||0),  "CANTIDAD EN KG", String(r.cantKg||0)+" kg");
  fila2("LOTE DEL SACO",       r.lote,           "MARCA DEL SACO",      r.marca);
  fila1("NUMERACI√ìN DEL SACO", r.numSaco);
  espacio(3);

  // ‚îÄ‚îÄ DEVOLUCI√ìN ‚îÄ‚îÄ
  filaAlterna = false;
  seccion("üîÑ  DEVOLUCI√ìN DE METABISULFITO DE SODIO DESDE LA PESCA");
  fila2("FECHA DE LA DEVOLUCI√ìN",          r.fechaDev,           "SACOS DEVUELTOS",           String(r.devSacos||0));
  fila2("KG DEVUELTOS",                    String(r.devKg||0)+" kg", "NUMERACI√ìN SACO DEV.",   r.devNumSaco);
  espacio(3);

  // ‚îÄ‚îÄ KG UTILIZADOS ‚îÄ‚îÄ
  const kgUsado = (parseFloat(r.cantKg)||0) - (parseFloat(r.devKg)||0);
  filaDestacada("KG EFECTIVAMENTE UTILIZADOS EN LA PESCA:", kgUsado.toFixed(2)+" KG", AZUL_ACA);

  // ‚îÄ‚îÄ OBSERVACIONES ‚îÄ‚îÄ
  if(r.observacion){
    filaAlterna = false;
    seccion("üìù  OBSERVACIONES");
    doc.setFillColor(...GRIS_FILA);
    doc.rect(M, y, CW, 16, "F");
    doc.setDrawColor(...BORDE_C); doc.setLineWidth(0.15);
    doc.rect(M, y, CW, 16, "S");
    doc.setFont("helvetica","normal"); doc.setFontSize(8); doc.setTextColor(...NEGRO);
    const lines = doc.splitTextToSize(limpiar(r.observacion), CW-7);
    doc.text(lines, M+4, y+5.5);
    espacio(20);
  }

  // ‚îÄ‚îÄ FIRMAS ‚îÄ‚îÄ
  espacio(8);
  const fw = 54, gap = (CW - fw*3) / 2;
  const firmas = [
    ["ENCARGADO DE DESPACHO", limpiar(r.despachador)],
    ["TRANSPORTISTA",          limpiar(r.conductor)],
    ["RECIBIDO POR",           limpiar(r.solicitadoPor)]
  ];

  firmas.forEach(([titulo, nombre], i) => {
    const fx = M + i*(fw+gap);
    // Firma box
    doc.setFillColor(...GRIS_FILA);
    doc.rect(fx, y, fw, 22, "F");
    doc.setDrawColor(...BORDE_C); doc.setLineWidth(0.2);
    doc.rect(fx, y, fw, 22, "S");
    // Accent top bar
    doc.setFillColor(...AZUL_MED);
    doc.rect(fx, y, fw, 3, "F");
    // Firma line
    doc.setDrawColor(...AZUL_MED); doc.setLineWidth(0.5);
    doc.line(fx+5, y+15, fx+fw-5, y+15);
    // Labels
    doc.setFont("helvetica","bold"); doc.setFontSize(6); doc.setTextColor(...GRIS_LBL);
    doc.text(titulo, fx+fw/2, y+19.5, {align:"center"});
    doc.setFont("helvetica","normal"); doc.setFontSize(7.5); doc.setTextColor(...NEGRO);
    const nn = doc.splitTextToSize(nombre||"", fw-6);
    doc.text(nn[0]||"", fx+fw/2, y+11, {align:"center"});
  });

  // ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ
  doc.setFillColor(...AZUL_OSC);
  doc.rect(0, 284, W, 13, "F");
  doc.setFillColor(...AZUL_ACA);
  doc.rect(0, 284, W, 1.2, "F");
  doc.setFont("helvetica","normal"); doc.setFontSize(6.5); doc.setTextColor(150, 185, 210);
  const ahora = new Date();
  const ahoraStr = ahora.getDate()+"/"+(ahora.getMonth()+1)+"/"+ahora.getFullYear()+" "+ahora.getHours()+":"+String(ahora.getMinutes()).padStart(2,"0");
  doc.text("MARECUADOR CIA. LTDA.  |  FOR-BOD-05  |  Generado: "+ahoraStr, W/2, 290.5, {align:"center"});
  doc.setFont("helvetica","bold"); doc.setFontSize(7); doc.setTextColor(180, 210, 230);
  doc.text("No. "+limpiar(r.numeracion), W/2, 294.5, {align:"center"});

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ABRIR Y DESCARGAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // Abrir en nueva pesta√±a para visualizar e imprimir, luego descargar
  const pdfBlob = doc.output("blob");
  const pdfUrl  = URL.createObjectURL(pdfBlob);
  const win = window.open(pdfUrl, "_blank");
  // Si el navegador bloquea popups, igual descarga
  if(!win) doc.save("Despacho_"+limpiar(r.numeracion)+"_"+(r.fechaDespacho||"sin-fecha")+".pdf");
  // Tambi√©n disparar descarga directa
  doc.save("Despacho_"+limpiar(r.numeracion)+"_"+(r.fechaDespacho||"sin-fecha")+".pdf");
}

// ‚îÄ‚îÄ‚îÄ USUARIOS ‚îÄ‚îÄ‚îÄ
window.crearUsuario=async function(){
  const nombre=v("u-nombre"),email=v("u-email"),pass=v("u-pass"),rol=g("u-rol").value;
  if(!nombre||!email||!pass){showAlert("Completa todos los campos.","error");return;}
  if(pass.length<6){showAlert("Contrase√±a m√≠nimo 6 caracteres.","error");return;}
  const btn=g("btn-crear"); btn.disabled=true; btn.innerHTML='<span class="spinner"></span>';
  try{
    const cred=await createUserWithEmailAndPassword(auth,email,pass);
    await setDoc(doc(db,CUSR,cred.user.uid),{nombre,email,rol,activo:true,creadoPor:curNombre,creadoEn:new Date().toISOString()});
    ["u-nombre","u-email","u-pass"].forEach(id=>g(id).value=""); g("u-rol").value="operario";
    showAlert("‚úÖ Usuario "+nombre+" creado como "+rol+".","success");
    cargarUsuarios();
  }catch(e){
    let m=e.message;
    if(e.code==="auth/email-already-in-use") m="Ese correo ya est√° registrado.";
    showAlert("Error: "+m,"error");
  }
  btn.disabled=false; btn.textContent="‚ûï CREAR USUARIO";
};

async function cargarUsuarios(){
  const wrap=g("lista-usuarios");
  try{
    const snap=await getDocs(collection(db,CUSR));
    const users=snap.docs.map(d=>({id:d.id,...d.data()}));
    if(!users.length){wrap.innerHTML='<div class="empty">Sin usuarios</div>';return;}
    wrap.innerHTML=users.map(u=>`
      <div class="user-row">
        <div class="u-avatar ${u.rol==="admin"?"ua-admin":"ua-op"}">${(u.nombre||"?")[0].toUpperCase()}</div>
        <div class="u-info">
          <div class="u-name">${u.nombre||"Sin nombre"}</div>
          <div class="u-email">${u.email}</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
          <span class="badge ${u.rol==="admin"?"b-yellow":"b-blue"}">${u.rol}</span>
          <span class="badge ${u.activo!==false?"b-green":"b-red"}">${u.activo!==false?"activo":"inactivo"}</span>
        </div>
        <div class="u-actions">
          ${u.activo!==false
            ?`<button class="btn btn-sm btn-warn" onclick="toggleUser('${u.id}',false)">Desact.</button>`
            :`<button class="btn btn-sm btn-success" onclick="toggleUser('${u.id}',true)">Activar</button>`}
          ${u.rol==="operario"
            ?`<button class="btn btn-sm btn-ghost" onclick="changeRole('${u.id}','admin')">‚Üí Admin</button>`
            :`<button class="btn btn-sm btn-ghost" onclick="changeRole('${u.id}','operario')">‚Üí Op.</button>`}
        </div>
      </div>`).join("");
  }catch(e){wrap.innerHTML=`<div class="empty">Error: ${e.message}</div>`;}
}
window.toggleUser=async(uid,s)=>{await updateDoc(doc(db,CUSR,uid),{activo:s});showAlert(s?"Usuario activado.":"Usuario desactivado.","info");cargarUsuarios();};
window.changeRole=async(uid,r)=>{if(!confirm("¬øCambiar rol a "+r+"?"))return;await updateDoc(doc(db,CUSR,uid),{rol:r});showAlert("Rol actualizado.","info");cargarUsuarios();};

// ‚îÄ‚îÄ‚îÄ SWITCH TAB ‚îÄ‚îÄ‚îÄ


// ‚îÄ‚îÄ‚îÄ AUTO PLACA desde conductor ‚îÄ‚îÄ‚îÄ
window.autoPlaca = function(val){
  const sel = document.getElementById("f-conductor");
  const opt = sel ? sel.querySelector('option[value="'+val+'"]') : null;
  const placa = opt ? (opt.getAttribute("data-placa") || "") : "";
  const placaInput = document.getElementById("f-placa");
  const manualWrap = document.getElementById("f-conductor-manual-wrap");
  if(!placaInput) return;
  if(val === "OTRO"){
    placaInput.removeAttribute("readonly");
    placaInput.style.background = "var(--bg)";
    placaInput.style.color = "var(--text)";
    placaInput.style.fontWeight = "normal";
    placaInput.style.letterSpacing = "normal";
    placaInput.value = "";
    placaInput.placeholder = "Ingresa la placa manualmente";
    if(manualWrap) manualWrap.style.display = "flex";
  } else {
    placaInput.setAttribute("readonly","true");
    placaInput.style.background = "#070e1a";
    placaInput.style.color = "var(--cyan)";
    placaInput.style.fontWeight = "700";
    placaInput.style.letterSpacing = "2px";
    placaInput.value = placa;
    if(manualWrap) manualWrap.style.display = "none";
  }
};

// ‚îÄ‚îÄ‚îÄ KARDEX ‚îÄ‚îÄ‚îÄ
// Estructura igual al Excel FOR-BOD-05:
// Cada despacho genera 1 fila de EGRESO (cantKg despachado)
// Cada devolucion genera 1 fila de INGRESO (devKg devuelto)
// El saldo corre en tiempo real: saldo = saldo_anterior + ingresos - egresos
// Los sitios del Excel se mapean a los valores de lugarPesca/puntoLlegada ingresados

const SITIO_LABELS = {
  "todos":                          "Todos los sitios - Consolidado",
  "Icemart-Logistica":              "Icemart - Logistica",
  "Mare Sta. Rosa":                 "Mare Sta. Rosa",
  "Mare El Cambio":                 "Mare El Cambio",
  "Icemart-Mare":                   "Icemart - Mare",
};

window.cargarKardex = async function(){
  const sitioKey = (document.getElementById("k-sitio")?.value || "todos").trim();
  const desde    = document.getElementById("k-desde")?.value || "";
  const hasta    = document.getElementById("k-hasta")?.value || "";
  const wrap     = document.getElementById("tabla-kardex");
  if(!wrap) return;

  wrap.innerHTML = '<div class="empty"><span class="spinner"></span> Calculando kardex...</div>';

  try {
    // Traer todos los despachos ordenados por fecha
    const q = query(collection(db, CDESP), orderBy("fechaDespacho","asc"), orderBy("createdAt","asc"));
    const snap = await getDocs(q);
    const todos = snap.docs.map(d => ({ id:d.id, ...d.data() }));

    // Filtrar por sitio
    let movsBase = todos;
    if(sitioKey !== "todos"){
      movsBase = todos.filter(r => {
        const lugar = (r.lugarPesca||"").toLowerCase();
        const destino = (r.puntoLlegada||"").toLowerCase();
        const combinado = lugar + " " + destino;
        // Normalizar key para busqueda flexible
        const palabras = sitioKey.toLowerCase()
          .replace("icemart","").replace("logistica","logist")
          .replace("sta. rosa","sta rosa").replace("el cambio","cambio")
          .split(" ").filter(p=>p.length>2);
        return palabras.some(p => combinado.includes(p));
      });
      // Si no matchea nada, mostrar todos (para sitios sin lugar pesca definido)
      if(movsBase.length === 0) movsBase = todos;
    }

    // Filtrar por fecha
    if(desde) movsBase = movsBase.filter(r => (r.fechaDespacho||"") >= desde);
    if(hasta) movsBase = movsBase.filter(r => (r.fechaDespacho||"") <= hasta);

    // ‚îÄ‚îÄ Construir filas del kardex ‚îÄ‚îÄ
    // Combinar datos de Firebase + datos importados desde Excel (si los hay)
    // Combinar datos hist√≥ricos del Excel embebido + cualquier archivo adicional subido
    const excelData = [...EXCEL_HISTORICO, ...(window._excelKardexData || [])];
    // Filtrar datos excel por sitio y fecha igual que Firebase
    let excelFiltrado = excelData;
    if(sitioKey !== "todos"){
      const palabras = sitioKey.toLowerCase()
        .replace("icemart","").replace("logistica","logist")
        .replace("sta. rosa","sta rosa").replace("el cambio","cambio")
        .split(" ").filter(p=>p.length>2);
      excelFiltrado = excelData.filter(r => {
        const combinado = (r.destino||"").toLowerCase() + " " + (r.docRef||"").toLowerCase();
        return palabras.some(p => combinado.includes(p));
      });
    }
    if(desde) excelFiltrado = excelFiltrado.filter(r => r.fecha >= desde);
    if(hasta) excelFiltrado = excelFiltrado.filter(r => r.fecha <= hasta);

    const filas = [];

    // Primero agregar filas del Excel importado (hist√≥rico)
    excelFiltrado.forEach(r => {
      filas.push({
        tipo:      r.tipo,
        fecha:     r.fecha,
        kg:        r.kg,
        marca:     r.marca     || "-",
        lote:      r.lote      || "-",
        numSaco:   r.numSaco   || "-",
        docRef:    r.docRef    || "-",
        docEgreso: r.docEgreso || "-",
        placa:     r.placa     || "-",
        destino:   r.destino   || "-",
        conductor: r.conductor || "-",
        solicitado:"-",
        _raw: r._raw || { guiaMdi: r.guiaMdi||"", nroGuia: r.nroGuia||"" },
        _fromExcel: true,
      });
    });

    movsBase.forEach(r => {
      const kg   = parseFloat(r.cantKg)  || 0;
      const devkg= parseFloat(r.devKg)   || 0;
      // Fila EGRESO (despacho)
      if(kg > 0){
        filas.push({
          tipo:       "EGRESO",
          fecha:      r.fechaDespacho || "-",
          kg:         kg,
          marca:      r.marca  || "-",
          lote:       r.lote   || "-",
          numSaco:    r.numSaco|| "-",
          docRef:     r.numeracion || "-",
          docEgreso:  r.nroGuia || r.guiaMdi || "-",
          placa:      r.placa  || "-",
          destino:    r.lugarPesca || r.puntoLlegada || "-",
          conductor:  r.conductor  || "-",
          solicitado: r.solicitadoPor || "-",
          _raw: r,
        });
      }
      // Fila INGRESO (devolucion desde pesca)
      if(devkg > 0){
        filas.push({
          tipo:       "INGRESO",
          fecha:      r.fechaDev || r.fechaDespacho || "-",
          kg:         devkg,
          marca:      r.marca    || "-",
          lote:       r.lote     || "-",
          numSaco:    r.devNumSaco || "-",
          docRef:     "DEV-" + (r.numeracion||"-"),
          docEgreso:  "-",
          placa:      r.placa    || "-",
          destino:    r.lugarPesca || "-",
          conductor:  r.conductor  || "-",
          solicitado: r.solicitadoPor || "-",
          _raw: r,
        });
      }
    });

    // ‚îÄ‚îÄ Ordenar todas las filas por fecha (Excel + Firebase juntos) ‚îÄ‚îÄ
    filas.sort((a,b) => {
      if(a.fecha < b.fecha) return -1;
      if(a.fecha > b.fecha) return 1;
      // INGRESOS antes de EGRESOS en la misma fecha
      if(a.tipo === "INGRESO" && b.tipo === "EGRESO") return -1;
      if(a.tipo === "EGRESO" && b.tipo === "INGRESO") return 1;
      return 0;
    });

    // ‚îÄ‚îÄ Calcular saldo corriente ‚îÄ‚îÄ
    let saldo = 0;
    let totalIng = 0, totalEgr = 0;
    const filasConSaldo = filas.map((f, i) => {
      const saldoIni = saldo;
      if(f.tipo === "INGRESO"){
        saldo += f.kg;
        totalIng += f.kg;
      } else {
        saldo -= f.kg;
        totalEgr += f.kg;
      }
      return { ...f, saldoInicial: saldoIni, saldoFinal: saldo };
    });

    // ‚îÄ‚îÄ Stats ‚îÄ‚îÄ
    const statsEl = document.getElementById("k-stats");
    if(statsEl) statsEl.style.display = "grid";
    const set = (id,v) => { const e=document.getElementById(id); if(e) e.textContent=v; };
    set("k-total-ing", totalIng.toFixed(1)+" kg");
    set("k-total-egr", totalEgr.toFixed(1)+" kg");
    set("k-saldo-act", saldo.toFixed(1)+" kg");
    set("k-movs", filasConSaldo.length);

    if(!filasConSaldo.length){
      wrap.innerHTML = '<div class="empty">Sin movimientos para este sitio. Ingresa despachos primero.</div>';
      return;
    }

    // ‚îÄ‚îÄ Render tabla ‚îÄ‚îÄ
    const colorIng = "var(--green)";
    const colorEgr = "var(--orange)";

    wrap.innerHTML = `<div class="tbl-wrap"><table style="min-width:900px">
      <thead>
        <tr style="background:var(--bg)">
          <th colspan="7" style="background:#052e1a;color:var(--green);text-align:center;padding:6px">INGRESOS (Devoluciones de pesca / Transferencias)</th>
          <th colspan="6" style="background:#2d1a00;color:var(--orange);text-align:center;padding:6px">EGRESOS (Despachos)</th>
          <th colspan="3" style="background:var(--bg);text-align:center;padding:6px">SALDO / REFERENCIA</th>
        </tr>
        <tr>
          <th>No.</th>
          <th>Fecha</th>
          <th>Saldo Inicial</th>
          <th>Doc. Ingreso</th>
          <th>KG Ingreso</th>
          <th>Marca Ing.</th>
          <th>Lote / Num. Saco</th>
          <th>Doc. Egreso</th>
          <th>KG Egreso</th>
          <th>Marca Egr.</th>
          <th>Lote / Num. Saco</th>
          <th>Destino</th>
          <th>Placa</th>
          <th style="background:#0a1f35;color:var(--cyan)">Saldo Final</th>
          <th>Nro Guia</th>
          <th>Conductor</th>
        </tr>
      </thead>
      <tbody>${filasConSaldo.map((f,i) => {
        const esIng = f.tipo === "INGRESO";
        const rowBg = esIng ? "background:#052e1a1a" : "background:#2d1a001a";
        return `<tr style="${rowBg}" class="${f._fromExcel?'excel-row':''}">
          <td><span class="badge ${esIng?"b-green":"b-orange"}">${String(i+1).padStart(2,"0")}</span></td>
          <td style="white-space:nowrap;font-size:12px">${f.fecha}</td>
          <td style="text-align:right;font-family:monospace;color:var(--muted);font-size:12px">${f.saldoInicial.toFixed(0)} kg</td>
          ${esIng ? `
            <td style="font-size:11px;color:var(--green)">${f.docRef}</td>
            <td style="text-align:right;font-family:monospace;font-weight:700;color:var(--green)">${f.kg.toFixed(1)} kg</td>
            <td style="font-size:11px">${f.marca}</td>
            <td style="font-size:11px">${f.lote} / ${f.numSaco}</td>
            <td colspan="5" style="color:var(--muted);font-size:11px;text-align:center">‚Äî</td>
          ` : `
            <td colspan="4" style="color:var(--muted);font-size:11px;text-align:center">‚Äî</td>
            <td style="font-size:11px;color:var(--orange)">${f.docEgreso}</td>
            <td style="text-align:right;font-family:monospace;font-weight:700;color:var(--orange)">${f.kg.toFixed(1)} kg</td>
            <td style="font-size:11px">${f.marca}</td>
            <td style="font-size:11px">${f.lote} / ${f.numSaco}</td>
            <td style="font-size:12px">${f.destino}</td>
            <td style="font-size:11px;color:var(--cyan);font-family:monospace">${f.placa}</td>
          `}
          <td style="text-align:right;font-family:monospace;font-weight:800;font-size:13px;${f.saldoFinal>=0?"color:var(--cyan)":"color:var(--red);background:#2d0a0a"}">${f.saldoFinal.toFixed(0)} kg</td>
          <td style="font-size:11px">${f._raw.guiaMdi||f._raw.nroGuia||"-"}</td>
          <td style="font-size:11px">${f.conductor}</td>
        </tr>`;
      }).join("")}
      </tbody>
      <tfoot>
        <tr style="border-top:2px solid var(--border2)">
          <td colspan="3" style="color:var(--muted);font-weight:700;font-size:11px">TOTALES DEL PERIODO</td>
          <td></td>
          <td style="text-align:right;color:var(--green);font-weight:800;font-family:monospace">${totalIng.toFixed(1)} kg</td>
          <td colspan="3"></td>
          <td style="text-align:right;color:var(--orange);font-weight:800;font-family:monospace">${totalEgr.toFixed(1)} kg</td>
          <td colspan="4"></td>
          <td style="text-align:right;color:var(--cyan);font-weight:800;font-family:monospace">${saldo.toFixed(1)} kg</td>
          <td colspan="2"></td>
        </tr>
      </tfoot>
    </table></div>`;

  } catch(e){
    wrap.innerHTML = '<div class="empty">Error al cargar: '+limpiar(e.message)+'</div>';
    console.error(e);
  }
};

window.switchTab=function(i){
  [0,1,2,3,4,5].forEach(j=>{
    const t=g("tab-"+j); if(t) t.style.display=j===i?"block":"none";
    const n=g("nav-"+j); if(n) n.classList.toggle("active",j===i);
  });
  if(i===1&&curRole==="admin") renderDashboard();
};

// ‚îÄ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ‚îÄ
function v(id){return g(id)?.value.trim()||"";}
function g(id){return document.getElementById(id);}
function show(id,d="block"){g(id).style.display=d;}
function hide(id){g(id).style.display="none";}
function limpiarForm(){
  ["f-placa","f-conductor","f-conductor-manual","f-fechaInicio","f-horaSalida","f-puntoPartida","f-fechaFin",
   "f-horaLlegada","f-puntoLlegada","f-ruta","f-guiaMdi","f-lugarPesca","f-nroGuia",
   "f-codRecibidor","f-fechaDespacho","f-solicitadoPor","f-despachador","f-cantSacos",
   "f-cantKg","f-lote","f-marca","f-numSaco","f-fechaDev","f-devSacos","f-devKg",
   "f-devNumSaco","f-obs"].forEach(id=>{const e=document.getElementById(id);if(e)e.value="";});
  const csel=document.getElementById("f-conductor");
  if(csel) csel.value="";
  const pf=document.getElementById("f-placa");
  if(pf){pf.value="";pf.setAttribute("readonly","true");pf.style.background="#070e1a";pf.style.color="var(--cyan)";}
  const mw=document.getElementById("f-conductor-manual-wrap"); if(mw) mw.style.display="none";
}
function showAlert(msg,type="success"){
  const b=document.getElementById("alert-box");
  b.innerHTML=`<div class="alert alert-${type}">${msg}</div>`;
  setTimeout(()=>b.innerHTML="",5000);
}
function showLoginErr(msg){const e=document.getElementById("lerror");e.textContent=msg;e.style.display="block";}

// ‚îÄ‚îÄ‚îÄ EDITAR REGISTRO (admin) ‚îÄ‚îÄ‚îÄ
let editingId = null;

window.editarRegistro = function(id){
  if(curRole !== "admin"){ showAlert("Solo los administradores pueden editar registros.","error"); return; }
  const r = allReg.find(x => x.id === id);
  if(!r) return;
  editingId = id;
  document.getElementById("edit-num").textContent = "N¬∞ " + r.numeracion;
  // Fill all fields
  const set = (fid, val) => { const e = document.getElementById(fid); if(e) e.value = val || ""; };
  set("e-conductor",    r.conductor);    set("e-placa",        r.placa);
  set("e-fechaInicio",  r.fechaInicio);  set("e-horaSalida",   r.horaSalida);
  set("e-puntoPartida", r.puntoPartida); set("e-fechaFin",     r.fechaFin);
  set("e-horaLlegada",  r.horaLlegada);  set("e-puntoLlegada", r.puntoLlegada);
  set("e-ruta",         r.ruta);         set("e-guiaMdi",      r.guiaMdi);
  set("e-lugarPesca",   r.lugarPesca);   set("e-nroGuia",      r.nroGuia);
  set("e-codRecibidor", r.codRecibidor); set("e-fechaDespacho",r.fechaDespacho);
  set("e-solicitadoPor",r.solicitadoPor);set("e-despachador",  r.despachador);
  set("e-cantSacos",    r.cantSacos);    set("e-cantKg",       r.cantKg);
  set("e-lote",         r.lote);         set("e-marca",        r.marca);
  set("e-numSaco",      r.numSaco);      set("e-fechaDev",     r.fechaDev);
  set("e-devSacos",     r.devSacos);     set("e-devKg",        r.devKg);
  set("e-devNumSaco",   r.devNumSaco);   set("e-obs",          r.observacion);
  document.getElementById("modal-edit").style.display = "flex";
};

window.closeEditModal = function(){
  document.getElementById("modal-edit").style.display = "none";
  editingId = null;
};

window.guardarEdicion = async function(){
  if(!editingId){ showAlert("Error: no hay registro seleccionado.","error"); return; }
  const get = id => { const e = document.getElementById(id); return e ? e.value.trim() : ""; };
  if(!get("e-fechaDespacho")){ showAlert("La fecha del despacho es obligatoria.","error"); return; }
  const btn = document.getElementById("btn-guardar-edit");
  btn.disabled = true; btn.innerHTML = '<span class="spinner"></span> Guardando...';
  try{
    const updates = {
      conductor:    get("e-conductor"),    placa:       get("e-placa"),
      fechaInicio:  get("e-fechaInicio"),  horaSalida:  get("e-horaSalida"),
      puntoPartida: get("e-puntoPartida"), fechaFin:    get("e-fechaFin"),
      horaLlegada:  get("e-horaLlegada"),  puntoLlegada:get("e-puntoLlegada"),
      ruta:         get("e-ruta"),         guiaMdi:     get("e-guiaMdi"),
      lugarPesca:   get("e-lugarPesca"),   nroGuia:     get("e-nroGuia"),
      codRecibidor: get("e-codRecibidor"), fechaDespacho:get("e-fechaDespacho"),
      solicitadoPor:get("e-solicitadoPor"),despachador: get("e-despachador"),
      cantSacos:    parseFloat(get("e-cantSacos"))||0,
      cantKg:       parseFloat(get("e-cantKg"))||0,
      lote:         get("e-lote"),         marca:       get("e-marca"),
      numSaco:      get("e-numSaco"),      fechaDev:    get("e-fechaDev"),
      devSacos:     parseFloat(get("e-devSacos"))||0,
      devKg:        parseFloat(get("e-devKg"))||0,
      devNumSaco:   get("e-devNumSaco"),   observacion: get("e-obs"),
      editadoPor:   curNombre,             editadoEn:   new Date().toISOString()
    };
    await updateDoc(doc(db, CDESP, editingId), updates);
    closeEditModal();
    await cargarTodo();
    showAlert("‚úÖ Registro actualizado correctamente.", "success");
  } catch(e){ showAlert("Error al guardar: " + e.message, "error"); }
  btn.disabled = false; btn.textContent = "üíæ GUARDAR CAMBIOS";
};

// ‚îÄ‚îÄ‚îÄ IMPORTAR EXCEL AL KARDEX ‚îÄ‚îÄ‚îÄ
// Estructura esperada del Excel (igual que FOR-BOD-05):
// Columnas: Fecha | Tipo (INGRESO/EGRESO) | Doc/Referencia | KG | Marca | Lote | Num.Saco | Destino | Placa | Conductor | Gu√≠a/NroGuia | Saldo
window.importarExcelKardex = function(input){
  const file = input.files[0];
  if(!file) return;
  const status = document.getElementById("k-import-status");
  status.style.display = "block";
  status.innerHTML = '<div class="alert alert-info">‚è≥ Leyendo archivo Excel...</div>';

  const reader = new FileReader();
  reader.onload = function(e){
    try{
      const data = new Uint8Array(e.target.result);
      const wb   = XLSX.read(data, {type:"array"});
      const ws   = wb.Sheets[wb.SheetNames[0]];
      const rows = XLSX.utils.sheet_to_json(ws, {header:1, defval:""});

      if(rows.length < 2){
        status.innerHTML = '<div class="alert alert-error">‚ùå El archivo est√° vac√≠o o no tiene datos.</div>';
        return;
      }

      // Detect header row
      const header = rows[0].map(h => String(h).toLowerCase().trim());
      const col = name => {
        const variants = {
          fecha:     ["fecha","date","f.despacho","fecha despacho"],
          tipo:      ["tipo","type","movimiento"],
          docRef:    ["doc","referencia","doc.ingreso","doc ingreso","documento","doc.egreso","doc egreso","nro guia","nroguia","guia"],
          kg:        ["kg","kilos","kilogramos","cantidad kg","kg ingreso","kg egreso","cantkg"],
          marca:     ["marca","brand","marca ing","marca egr"],
          lote:      ["lote","batch"],
          numSaco:   ["num.saco","num saco","numeracion saco","numsaco","saco"],
          destino:   ["destino","lugar","lugar pesca","puntoLlegada"],
          placa:     ["placa","vehiculo"],
          conductor: ["conductor","chofer","transportista"],
          guia:      ["guia","nro guia","nroguia","guia mdi","guiamdi"],
        };
        const v = variants[name] || [name];
        for(let i=0;i<header.length;i++){
          if(v.some(vn => header[i].includes(vn))) return i;
        }
        return -1;
      };

      // Map rows to kardex records
      let importados = 0;
      const registros = [];
      for(let i=1; i<rows.length; i++){
        const row = rows[i];
        if(!row || row.every(c => c === "")) continue;

        // Parse date
        let fecha = "";
        const rawFecha = row[col("fecha")] || "";
        if(rawFecha){
          if(typeof rawFecha === "number"){
            // Excel serial date
            const d = new Date(Math.round((rawFecha - 25569) * 86400 * 1000));
            fecha = d.toISOString().slice(0,10);
          } else {
            // Try parsing string date dd/mm/yyyy or yyyy-mm-dd
            const s = String(rawFecha).trim();
            const parts = s.includes("/") ? s.split("/") : s.split("-");
            if(parts.length === 3){
              if(s.includes("-") && parts[0].length===4) fecha = s; // already yyyy-mm-dd
              else fecha = parts[2]+"-"+parts[1].padStart(2,"0")+"-"+parts[0].padStart(2,"0");
            }
          }
        }
        if(!fecha) continue;

        // Detect tipo: INGRESO or EGRESO
        let tipo = "EGRESO";
        const rawTipo = String(row[col("tipo")] || "").toUpperCase();
        if(rawTipo.includes("ING") || rawTipo.includes("DEVOL") || rawTipo.includes("ENTR")) tipo = "INGRESO";

        const kg = parseFloat(String(row[col("kg")]||"0").replace(",",".")) || 0;
        if(kg <= 0) continue;

        registros.push({
          _fromExcel: true,
          fecha,
          tipo,
          docRef:    String(row[col("docRef")]   || ""),
          docEgreso: String(row[col("docRef")]   || ""),
          kg,
          marca:     String(row[col("marca")]    || ""),
          lote:      String(row[col("lote")]     || ""),
          numSaco:   String(row[col("numSaco")]  || ""),
          destino:   String(row[col("destino")]  || ""),
          placa:     String(row[col("placa")]    || ""),
          conductor: String(row[col("conductor")]|| ""),
          guiaMdi:   String(row[col("guia")]     || ""),
          nroGuia:   String(row[col("guia")]     || ""),
          _raw: { guiaMdi: row[col("guia")]||"", nroGuia: row[col("guia")]||"" }
        });
        importados++;
      }

      if(!importados){
        status.innerHTML = '<div class="alert alert-error">‚ùå No se encontraron filas v√°lidas. Verifica que el Excel tenga columnas de Fecha, Tipo, KG.</div>';
        return;
      }

      // Store in memory for kardex rendering
      window._excelKardexData = registros;
      status.innerHTML = '<div class="alert alert-success">‚úÖ '+importados+' registros importados desde Excel. El kardex ahora incluye datos hist√≥ricos del archivo.</div>';
      // Re-render kardex with merged data
      cargarKardex();
      // Reset input so same file can be reloaded
      input.value = "";
    } catch(err){
      status.innerHTML = '<div class="alert alert-error">‚ùå Error al leer el Excel: '+err.message+'</div>';
      console.error(err);
    }
  };
  reader.readAsArrayBuffer(file);
};

</script>
</body>
</html>
